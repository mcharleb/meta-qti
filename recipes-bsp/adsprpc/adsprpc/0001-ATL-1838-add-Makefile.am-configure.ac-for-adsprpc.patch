From 9393be64669d09dabc1a037167e678d5325e7644 Mon Sep 17 00:00:00 2001
From: willc <willc@qti.qualcomm.com>
Date: Tue, 18 Nov 2014 09:58:10 -0800
Subject: [PATCH] ATL-1838-add-Makefile.am-configure.ac-for-adsprpc

---
 Makefile.am  | 64 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 configure.ac | 50 +++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 114 insertions(+)
 create mode 100644 Makefile.am
 create mode 100644 configure.ac

diff --git a/Makefile.am b/Makefile.am
new file mode 100644
index 0000000..7463198
--- /dev/null
+++ b/Makefile.am
@@ -0,0 +1,64 @@
+# ---------------------------------------------------------------------------------
+#                           Common definitons
+# ---------------------------------------------------------------------------------
+AM_CFLAGS = -g -O3
+AM_CFLAGS += -fno-short-enums
+AM_CFLAGS += -D_DEBUG
+AM_CFLAGS += -DARM_ARCH_7A
+AM_CPPFLAGS =  -DUSE_KK_CODE
+
+# ---------------------------------------------------------------------------------
+#                       Make the shared library (libadsprpc)
+# ---------------------------------------------------------------------------------
+
+lib_LTLIBRARIES = libadsprpc.la
+
+libadsprpc_la_SOURCES = \
+        $(abs_srcdir)/src/fastrpc_apps_user.c \
+        $(abs_srcdir)/src/remotectl_stub.c \
+        $(abs_srcdir)/src/listener_android.c \
+        $(abs_srcdir)/src/adsp_current_process_stub.c \
+        $(abs_srcdir)/src/apps_std_skel.c \
+        $(abs_srcdir)/src/apps_std_imp.c \
+        $(abs_srcdir)/src/apps_mem_imp.c \
+        $(abs_srcdir)/src/apps_mem_skel.c \
+        $(abs_srcdir)/src/rpcmem.c \
+        $(abs_srcdir)/src/apps_remotectl_skel.c \
+        $(abs_srcdir)/src/std.c \
+        $(abs_srcdir)/src/std_mem.c \
+        $(abs_srcdir)/src/std_dtoa.c \
+        $(abs_srcdir)/src/std_strlprintf.c \
+        $(abs_srcdir)/src/BufBound.c \
+        $(abs_srcdir)/src/std_SwapBytes.c \
+        $(abs_srcdir)/src/smath.c 
+
+libadsprpc_la_CFLAGS = $(AM_CFLAGS)
+libadsprpc_la_CPPFLAGS = $(AM_CPPFLAGS) $(CPPFLAGS) -fPIC
+libadsprpc_la_CPPFLAGS += -I$(abs_srcdir)/inc/
+libadsprpc_la_CPPFLAGS += -I$(abs_srcdir)/src/
+libadsprpc_la_LIBADD = -ldl -lpthread -lm
+libadsprpc_la_LDFLAGS = -shared $(DEBUG_LDFLAGS) -Wl,--version-script=$(abs_srcdir)/src/symbols.lst
+
+# install library interface header into ${includedir}
+include_HEADERS = inc/remote.h
+
+# ---------------------------------------------------------------------------------
+#                       Make the daemon adsprpcd
+# ---------------------------------------------------------------------------------
+
+bin_PROGRAMS = adsprpcd
+
+adsprpcd_SOURCES = \
+        $(abs_srcdir)/src/adsprpcd.c \
+        $(abs_srcdir)/src/adsp_default_listener_stub.c 
+
+adsprpcd_LDFLAGS = $(DEBUG_LDFLAGS)
+adsprpcd_LDADD = libadsprpc.la  
+adsprpcd_CFLAGS = $(AM_CFLAGS) $(DEBUG_CFLAGS)
+adsprpcd_CPPFLAGS = $(AM_CPPFLAGS) $(CPPFLAGS) -fPIC
+adsprpcd_CPPFLAGS += -I$(abs_srcdir)/inc/
+adsprpcd_CPPFLAGS += -I$(abs_srcdir)/src/
+
+# ---------------------------------------------------------------------------------
+#                                      END
+# ---------------------------------------------------------------------------------
diff --git a/configure.ac b/configure.ac
new file mode 100644
index 0000000..a4ca695
--- /dev/null
+++ b/configure.ac
@@ -0,0 +1,50 @@
+#                                               -*- Autoconf -*-
+# configure.ac -- Autoconf script for adsprpc
+#
+
+# Process this file with autoconf to produce a configure script.
+
+AC_PREREQ(2.61)
+AC_INIT([adsprpc],1.0.0)
+
+AM_INIT_AUTOMAKE([-Werror -Wall gnu foreign subdir-objects])
+AM_MAINTAINER_MODE
+
+AC_CONFIG_HEADER([config.h])
+
+# Checks for programs.
+AM_PROG_AR
+AC_PROG_CC
+AC_PROG_CPP
+AC_PROG_CXX
+AM_PROG_CC_C_O
+AC_PROG_LIBTOOL
+AC_PROG_AWK
+AC_PROG_INSTALL
+AC_PROG_LN_S
+AC_PROG_MAKE_SET
+
+# Checks for typedefs, structures, and compiler characteristics.
+AC_TYPE_SIZE_T
+AC_TYPE_SSIZE_T
+AC_TYPE_UINT16_T
+AC_TYPE_UINT32_T
+AC_TYPE_UINT64_T
+AC_TYPE_UINT8_T
+
+AC_CHECK_TOOL(OBJCOPY, objcopy, false)
+
+AC_ARG_WITH([sanitized-headers],
+	[AS_HELP_STRING([--with-sanitized-headers=DIR],[location of the sanitized Linux kernel headers])],
+	[CFLAGS="$CFLAGS -I $withval"])
+
+AC_ARG_WITH([common-includes],
+	[AS_HELP_STRING([--with-common-includes=DIR],[location of common headers])],
+	[CPPFLAGS="$CPPFLAGS -I$withval"])
+
+
+AC_CONFIG_FILES([ \
+    Makefile \
+       ])
+AC_OUTPUT
+
-- 
1.8.5.2

