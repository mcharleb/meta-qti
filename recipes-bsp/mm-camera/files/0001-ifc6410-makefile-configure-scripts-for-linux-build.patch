From 9ede7f118d751d8ed4e9f5a1fee2340bad169996 Mon Sep 17 00:00:00 2001
From: Kaustubh Gondkar <kgondkar@qti.qualcomm.com>
Date: Wed, 18 Jun 2014 17:01:51 -0700
Subject: [PATCH] makefile configure scripts for linux build

Change-Id: I125fb76afd94afce2978595b55ab5bc05baa4ef1
---
 apps/Makefile.am                                   |   1 -
 apps/appslib/Makefile.am                           |  49 ++--
 apps/mm-qcamera-app/Makefile.am                    |  40 ++-
 apps/mm-qcamera-app/configure.ac                   |  76 ++++++
 apps/v4l2-qcamera-app/Makefile.am                  |  18 +-
 configure.ac                                       |  37 ++-
 server/Makefile.am                                 | 272 +++++++++++++++------
 .../chromatix_ov2720/preview/Makefile.am           |  32 +++
 .../chromatix_s5k3l1yx/preview/Makefile.am         |  32 +++
 .../chromatix_s5k3l1yx/video/Makefile.am           |  32 +++
 .../chromatix_s5k3l1yx/zsl/Makefile.am             |  32 +++
 .../chromatix_s5k4e1/preview/Makefile.am           |  22 +-
 .../chromatix_s5k4e1/video/Makefile.am             |  22 +-
 .../chromatix_vx6953/preview/Makefile.am           |  22 +-
 .../chromatix_vx6953/video/Makefile.am             |  23 +-
 15 files changed, 545 insertions(+), 165 deletions(-)
 create mode 100644 apps/mm-qcamera-app/configure.ac
 create mode 100644 server/chromatix/0208/libchromatix/chromatix_ov2720/preview/Makefile.am
 create mode 100644 server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/preview/Makefile.am
 create mode 100644 server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/video/Makefile.am
 create mode 100644 server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/zsl/Makefile.am

diff --git a/apps/Makefile.am b/apps/Makefile.am
index c7148ea..4f678f0 100644
--- a/apps/Makefile.am
+++ b/apps/Makefile.am
@@ -3,7 +3,6 @@ dirs :=
 
 if ARM
 dirs += appslib
-dirs += mm-qcamera-app
 dirs += v4l2-qcamera-app
 endif
 
diff --git a/apps/appslib/Makefile.am b/apps/appslib/Makefile.am
index 6cc5bd5..afd23bc 100644
--- a/apps/appslib/Makefile.am
+++ b/apps/appslib/Makefile.am
@@ -8,25 +8,31 @@ libmmcamera_core_la_CFLAGS += -D_GNU_SOURCE
 libmmcamera_core_la_CFLAGS += -DLINUX_ENABLED
 libmmcamera_core_la_CFLAGS += -fPIC
 libmmcamera_core_la_CFLAGS += -D__ARM_HAVE_NEON
-libmmcamera_core_la_CFLAGS += -DDISABLE_JPEG_ENCODING
+#libmmcamera_core_la_CFLAGS += -DDISABLE_JPEG_ENCODING
 libmmcamera_core_la_CFLAGS += -D_V4L2_BASED_CAM_
 
+libmmcamera_core_la_CFLAGS += -DUSE_ION
+libmmcamera_core_la_CFLAGS += -DHW_ENCODE
+if MSM8960
+libmmcamera_core_la_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_CP_MM_HEAP_ID
+else
+libmmcamera_core_la_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_CAMERA_HEAP_ID
+endif
+
 libmmcamera_core_la_CFLAGS += -I ../../common
+
 #for jpeg
-if MSM7X2X
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/jpeg
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/jpeg/inc
-endif
 if MSM7X27A
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/jpeg
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/jpeg/inc
-else
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/jpeg2
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/jpeg2/inc
+libmmcamera_core_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg
+libmmcamera_core_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libmmcamera_core_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2
+libmmcamera_core_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
 endif
 if MSM8660
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/mpo/src
-libmmcamera_core_la_CFLAGS += -I ../../../mm-still/mpo/inc
+libmmcamera_core_la_CFLAGS += -I $(MM_STILL_PATH)/mpo/src
+libmmcamera_core_la_CFLAGS += -I $(MM_STILL_PATH)/mpo/inc
 endif
 
 libmmcamera_core_la_SOURCES := cam_frame_q.c
@@ -37,7 +43,7 @@ libmmcamera_core_la_SOURCES += cam_display.c
 libmmcamera_core_la_SOURCES += cam_stats.c
 #enable when snapshot is supported
 libmmcamera_core_la_SOURCES += snapshot.c
-#libmmcamera_core_la_SOURCES += jpeg_encoder.c
+libmmcamera_core_la_SOURCES += jpeg_encoder.c
 libmmcamera_core_la_SOURCES += liveshot.c
 libmmcamera_core_la_SOURCES += yv12conversionroutines.c
 if MSM8660
@@ -94,7 +100,7 @@ if MSM8960
 liboemcamera_la_LIBADD += -lmmjpeg
 else
 #add when snapshot is supported
-#liboemcamera_la_LIBADD += -lmmjpeg
+liboemcamera_la_LIBADD += -lmmjpeg
 #liboemcamera_la_LIBADD += -lmmipl
 endif
 if MSM8660
@@ -109,22 +115,23 @@ bin_PROGRAMS := mm-qcamera-daemon
 mm_qcamera_daemon_CFLAGS := $(DEBUG_CFLAGS)
 mm_qcamera_daemon_CFLAGS += -DMSM_CAMERA_GCC
 mm_qcamera_daemon_CFLAGS += -DLINUX_ENABLED
-mm_qcamera_daemon_CFLAGS += -DDISABLE_JPEG_ENCODING
+#mm_qcamera_daemon_CFLAGS += -DDISABLE_JPEG_ENCODING
 
+mm_qcamera_daemon_CFLAGS += -DUSE_ION
 mm_qcamera_daemon_CFLAGS += -I ../appslib
 mm_qcamera_daemon_CFLAGS += -I ../../common
 
 #for jpeg
 if MSM7X2X
-mm_qcamera_daemon_CFLAGS += -I ../../../mm-still/jpeg
-mm_qcamera_daemon_CFLAGS += -I ../../../mm-still/jpeg/inc
+mm_qcamera_daemon_CFLAGS += -I $(MM_STILL_PATH)/jpeg
+mm_qcamera_daemon_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
 else
-mm_qcamera_daemon_CFLAGS += -I ../../../mm-still/jpeg2
-mm_qcamera_daemon_CFLAGS += -I ../../../mm-still/jpeg2/inc
+mm_qcamera_daemon_CFLAGS += -I $(MM_STILL_PATH)/jpeg2
+mm_qcamera_daemon_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
 endif
 if MSM8660
-mm_qcamera_daemon_CFLAGS += -I ../../../mm-still/mpo/src
-mm_qcamera_daemon_CFLAGS += -I ../../../mm-still/mpo/inc
+mm_qcamera_daemon_CFLAGS += -I $(MM_STILL_PATH)/mpo/src
+mm_qcamera_daemon_CFLAGS += -I $(MM_STILL_PATH)/mpo/inc
 endif
 
 mm_qcamera_daemon_SOURCES := override_malloc.c
diff --git a/apps/mm-qcamera-app/Makefile.am b/apps/mm-qcamera-app/Makefile.am
index 6a8a9e8..932d830 100644
--- a/apps/mm-qcamera-app/Makefile.am
+++ b/apps/mm-qcamera-app/Makefile.am
@@ -1,41 +1,39 @@
-
 # mm-qcamera-app
 bin_PROGRAMS := mm-qcamera-app
 
 mm_qcamera_app_CFLAGS := $(DEBUG_CFLAGS)
 mm_qcamera_app_CFLAGS += -DAMSS_VERSION=$(AMSS_VERSION)
-mm_qcamera_app_CFLAGS += -I ../appslib
-mm_qcamera_app_CFLAGS += -I ../../common
+
 #for jpeg
-#mm_qcamera_app_CFLAGS += -I ../../../mm-still/ipl/inc
-#mm_qcamera_app_CFLAGS += -I ../../../mm-still/jpeg/inc
+mm_qcamera_app_CFLAGS += -I $(MM_STILL_PATH)/ipl/inc
+if MSM7X27A
+mm_qcamera_app_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+mm_qcamera_app_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
 
+#for mm-camera-interface
+mm_qcamera_app_CFLAGS += $(CAMERA_HAL_CFLAGS)
 mm_qcamera_app_CFLAGS += -DMSM_CAMERA_GCC
 mm_qcamera_app_CFLAGS += -DLINUX_ENABLED
 mm_qcamera_app_CFLAGS += -D_V4L2_BASED_CAM_
-#remove when snapshot is supported
-mm_qcamera_app_CFLAGS += -DDISABLE_JPEG_ENCODING
-mm_qcamera_app_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_HEAP_ADSP_ID
+mm_qcamera_app_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_CP_MM_HEAP_ID
+mm_qcamera_app_CFLAGS += -DUSE_ION
 
-if MSM7630
-mm_qcamera_app_CFLAGS += -D_MSM7630_
-else
-if MSM7X27A
-mm_qcamera_app_CFLAGS += -D_MSM7627A_
-else
-mm_qcamera_app_CFLAGS += -D_MSM8960_
-endif
-endif
+#Enable this flag to disable jpeg encoding.
+#mm_qcamera_app_CFLAGS += -DDISABLE_JPEG_ENCODING
+#Enable this flag to enable hw jpeg encoding.
+mm_qcamera_app_CFLAGS += -DHW_ENCODE
 
+#sources
 mm_qcamera_app_SOURCES := mm_qcamera_app.c
 mm_qcamera_app_SOURCES += mm_qcamera_display.c
 mm_qcamera_app_SOURCES += mm_qcamera_main_menu.c
 mm_qcamera_app_SOURCES += mm_qcamera_preview.c
 mm_qcamera_app_SOURCES += mm_qcamera_snapshot.c
-#mm_qcamera_app_SOURCES += mm_qcamera_unit_test.c
 mm_qcamera_app_SOURCES += mm_qcamera_video.c
 
 mm_qcamera_app_LDFLAGS := $(DEBUG_LDFLAGS)
-mm_qcamera_app_LDADD := ../appslib/liboemcamera.la
-mm_qcamera_app_LDADD += -ldl
-
+mm_qcamera_app_LDADD := -ldl
+mm_qcamera_app_LDADD += $(CAMERA_HAL_LIBS)
diff --git a/apps/mm-qcamera-app/configure.ac b/apps/mm-qcamera-app/configure.ac
new file mode 100644
index 0000000..97b7dba
--- /dev/null
+++ b/apps/mm-qcamera-app/configure.ac
@@ -0,0 +1,76 @@
+AC_PREREQ(2.61)
+
+AC_INIT([mm-qcamera-app],1.0.0)
+AM_INIT_AUTOMAKE([-Wall gnu foreign subdir-objects])
+AM_MAINTAINER_MODE
+AC_CONFIG_HEADER([configure.h])
+AC_CONFIG_MACRO_DIR([m4])
+
+# Checks for programs.
+AM_PROG_AR
+AM_PROG_AS
+AC_PROG_CC
+AM_PROG_CC_C_O
+AC_PROG_LIBTOOL
+AC_PROG_AWK
+AC_PROG_CPP
+AC_PROG_INSTALL
+AC_PROG_LN_S
+AC_PROG_MAKE_SET
+
+# Checks for typedefs, structures, and compiler characteristics.
+AC_TYPE_SIZE_T
+AC_TYPE_SSIZE_T
+AC_TYPE_UINT16_T
+AC_TYPE_UINT32_T
+AC_TYPE_UINT64_T
+AC_TYPE_UINT8_T
+
+AC_CHECK_TOOL(OBJCOPY, objcopy, false)
+
+COMPILE_CAMERA=yes
+AMSS_VERSION=
+VFE_VERS=
+MSM_VERSION=
+DEBUG_CPPFLAGS=
+DEBUG_CFLAGS=
+DEBUG_LDFLAGS=
+
+PKG_CHECK_MODULES([CAMERA_HAL],[camera-hal])
+AC_SUBST([CAMERA_HAL_CFLAGS])
+AC_SUBST([CAMERA_HAL_LIBS])
+
+AC_ARG_WITH([sanitized-headers],
+	[AS_HELP_STRING([--with-sanitized-headers=DIR],[location of the sanitized Linux kernel headers])],
+	[CFLAGS="$CFLAGS -I$withval/media -I $withval"])
+
+AC_ARG_WITH([common-includes],
+	[AS_HELP_STRING([--with-common-includes=DIR],[location of additional headers to be included])],
+	[CFLAGS="$CFLAGS -I$withval -I$withval/libcamera2 -I$withval/cameracommon"])
+
+AC_ARG_WITH([mm-still],
+	[AS_HELP_STRING([--with-mm-still=DIR],[location of mm-still])],
+	[MM_STILL_PATH="$withval"])
+
+AC_ARG_ENABLE([target],
+	[AS_HELP_STRING([--enable-target=TARGET],[target to build for])],
+	[],
+	[enable_target=none]
+)
+
+if test "x$enable_target" = "xmsm7627a"; then
+        MSM_VERSION=7x27A
+elif test "x$enable_target" = "xmsm8960"; then
+        MSM_VERSION=8960
+else
+        MSM_VERSION=
+fi
+
+AC_SUBST([MSM_VERSION])
+AC_SUBST([MM_STILL_PATH])
+
+AM_CONDITIONAL([MSM7X27A], [test "x$MSM_VERSION" = "x7x27A"])
+AM_CONDITIONAL([MSM8960], [test "x$MSM_VERSION" = "x8960"])
+
+AC_OUTPUT([ \
+	Makefile
diff --git a/apps/v4l2-qcamera-app/Makefile.am b/apps/v4l2-qcamera-app/Makefile.am
index e60c14d..24ad8b5 100644
--- a/apps/v4l2-qcamera-app/Makefile.am
+++ b/apps/v4l2-qcamera-app/Makefile.am
@@ -7,15 +7,27 @@ v4l2_qcamera_app_CFLAGS += -DAMSS_VERSION=$(AMSS_VERSION)
 v4l2_qcamera_app_CFLAGS += -I ../appslib
 v4l2_qcamera_app_CFLAGS += -I ../../common
 #for jpeg
-#v4l2_qcamera_app_CFLAGS += -I ../../../mm-still/ipl/inc
-#v4l2_qcamera_app_CFLAGS += -I ../../../mm-still/jpeg/inc
+v4l2_qcamera_app_CFLAGS += -I $(MM_STILL_PATH)/ipl/inc
+if MSM7X27A
+v4l2_qcamera_app_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+v4l2_qcamera_app_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
 
 v4l2_qcamera_app_CFLAGS += -DMSM_CAMERA_GCC
 v4l2_qcamera_app_CFLAGS += -DLINUX_ENABLED
 #remove when snapshot is supported
-v4l2_qcamera_app_CFLAGS += -DDISABLE_JPEG_ENCODING
+#v4l2_qcamera_app_CFLAGS += -DDISABLE_JPEG_ENCODING
 v4l2_qcamera_app_CFLAGS += -D_V4L2_BASED_CAM_
 
+if MSM8960
+v4l2_qcamera_app_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_CP_MM_HEAP_ID
+else
+v4l2_qcamera_app_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_CAMERA_HEAP_ID
+endif
+v4l2_qcamera_app_CFLAGS += -DUSE_ION
+
 v4l2_qcamera_app_SOURCES := v4l2-qcamera-app.c
 
 v4l2_qcamera_app_LDFLAGS := $(DEBUG_LDFLAGS)
diff --git a/configure.ac b/configure.ac
index 010b03e..acb649a 100644
--- a/configure.ac
+++ b/configure.ac
@@ -2,7 +2,7 @@ AC_PREREQ(2.61)
 
 AC_INIT([mm-camera],1.0.0)
 
-AM_INIT_AUTOMAKE([-Werror -Wall gnu foreign subdir-objects])
+AM_INIT_AUTOMAKE([-Wall gnu foreign subdir-objects])
 
 AM_MAINTAINER_MODE
 
@@ -10,6 +10,7 @@ AC_CONFIG_HEADER([configure.h])
 AC_CONFIG_MACRO_DIR([m4])
 
 # Checks for programs.
+AM_PROG_AR
 AM_PROG_AS
 AC_PROG_CC
 AM_PROG_CC_C_O
@@ -42,10 +43,18 @@ AC_ARG_WITH([sanitized-headers],
 	[AS_HELP_STRING([--with-sanitized-headers=DIR],[location of the sanitized Linux kernel headers])],
 	[CFLAGS="$CFLAGS -I$withval/media -I $withval"])
 
+AC_ARG_WITH([common-includes],
+	[AS_HELP_STRING([--with-common-includes=DIR],[location of additional headers to be included])],
+	[CFLAGS="$CFLAGS -I$withval -I$withval/libcamera2 -I$withval/C2D"])
+
 AC_ARG_WITH([extra-cflags],
 	[AS_HELP_STRING([--with-extra-cflags=DIR],[additional compliation flags])],
 	[CFLAGS="$CFLAGS $withval"])
 
+AC_ARG_WITH([mm-still],
+	[AS_HELP_STRING([--with-mm-still=DIR],[location of mm-still])],
+	[MM_STILL_PATH="$withval"])
+
 AC_ARG_ENABLE([target],
 	[AS_HELP_STRING([--enable-target=TARGET],[target to build for])],
 	[],
@@ -86,9 +95,9 @@ elif test "x$enable_target" = "xmsm7630"; then
 	MSM_VERSION=7x30
 	DEBUG_CPPFLAGS=-DHW_ENCODE
 	DEBUG_CFLAGS=-DHW_ENCODE
-    FEATURE_FACE_PROC=true
-    FEATURE_WAVELET_DENOISE=true
-    FEATURE_VFE_TEST_VEC=false
+	FEATURE_FACE_PROC=true
+	FEATURE_WAVELET_DENOISE=true
+	FEATURE_VFE_TEST_VEC=false
 elif test "x$enable_target" = "xmsm8660"; then
 	VFE_VERS=vfe31
 	MSM_VERSION=8x60
@@ -103,8 +112,8 @@ elif test "x$enable_target" = "xmsm8960"; then
 	FEATURE_ZSL=true
 	FEATURE_FACE_PROC=true
 	FEATURE_VFE_TEST_VEC=false
-	DEBUG_CPPFLAGS=-DHW_ENCODE -DCONFIG_MSG_THESHOLD=350
-	DEBUG_CFLAGS=-DHW_ENCODE -DCONFIG_MSG_THESHOLD=350
+	DEBUG_CPPFLAGS=-DHW_ENCODE -DCONFIG_MSG_THESHOLD=350 -DUSE_GEMINI
+	DEBUG_CFLAGS=-DHW_ENCODE -DCONFIG_MSG_THESHOLD=350 -DUSE_GEMINI
 elif test "x$enable_target" = "xmsm7625"; then
 	VFE_VERS=vfe2x
 	MSM_VERSION=7x2x
@@ -150,6 +159,7 @@ AC_SUBST([DEBUG_LDFLAGS])
 AC_SUBST([FEATURE_FACE_PROC])
 AC_SUBST([FEATURE_WAVELET_DENOISE])
 AC_SUBST([FEATURE_VFE_TEST_VEC])
+AC_SUBST([MM_STILL_PATH])
 
 AM_CONDITIONAL([VFE2X], [test "x$VFE_VERS" = "xvfe2x"])
 AM_CONDITIONAL([VFE30], [test "x$VFE_VERS" = "xvfe30"])
@@ -177,12 +187,15 @@ AC_OUTPUT([ \
 	Makefile \
 	apps/Makefile \
 	apps/appslib/Makefile \
-	apps/mm-qcamera-app/Makefile \
 	apps/v4l2-qcamera-app/Makefile \
-    server/Makefile \
-    server/chromatix/0208/libchromatix/chromatix_vx6953/preview/Makefile \
-    server/chromatix/0208/libchromatix/chromatix_vx6953/video/Makefile \
-    server/chromatix/0208/libchromatix/chromatix_s5k4e1/preview/Makefile \
-    server/chromatix/0208/libchromatix/chromatix_s5k4e1/video/Makefile
+	server/Makefile \
+	server/chromatix/0208/libchromatix/chromatix_ov2720/preview/Makefile \
+	server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/preview/Makefile \
+	server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/video/Makefile \
+        server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/zsl/Makefile \
+        server/chromatix/0208/libchromatix/chromatix_vx6953/preview/Makefile \
+	server/chromatix/0208/libchromatix/chromatix_vx6953/video/Makefile \
+	server/chromatix/0208/libchromatix/chromatix_s5k4e1/preview/Makefile \
+	server/chromatix/0208/libchromatix/chromatix_s5k4e1/video/Makefile
 ])
 
diff --git a/server/Makefile.am b/server/Makefile.am
index 657bd19..17ab005 100644
--- a/server/Makefile.am
+++ b/server/Makefile.am
@@ -1,26 +1,5 @@
-
-# libmmcamera_server_assembly.a
-noinst_LTLIBRARIES := libmmcamera_server_assembly.la
-
-libmmcamera_server_assembly_la_CFLAGS := $(DEBUG_CFLAGS)
-libmmcamera_server_assembly_la_CFLAGS += -DMSM_CAMERA_GCC
-libmmcamera_server_assembly_la_CFLAGS += -DLINUX_ENABLED
-
-libmmcamera_server_assembly_la_SOURCES := frameproc/hdr/hdrcolorgamma_armv7_gcc.S
-libmmcamera_server_assembly_la_SOURCES += frameproc/hdr/hdrmotioncorrection_armv7_gcc.S
-libmmcamera_server_assembly_la_SOURCES += frameproc/hdr/hdrtonemap_armv7_gcc.S
-
-if WAVELET_DENOISE
-libmmcamera_server_assembly_la_SOURCES += frameproc/wavelet_denoise/edge_weighting_armv7_gcc.S
-libmmcamera_server_assembly_la_SOURCES += frameproc/wavelet_denoise/idwt_filters_armv7_gcc.S
-libmmcamera_server_assembly_la_SOURCES += frameproc/wavelet_denoise/dwt_filters_armv7_gcc.S
-endif
-
-include ../override_mem_alloc_dealloc.am
-libmmcamera_server_assembly_la_DEPENDENCIES := $(call override_mem_alloc_dealloc,$(libmmcamera_server_assembly_la_OBJECTS))
-
 # libmmcamera_target.a
-noinst_LTLIBRARIES += libmmcamera_target.la
+noinst_LTLIBRARIES = libmmcamera_target.la
 
 libmmcamera_target_la_CFLAGS := $(DEBUG_CFLAGS)
 libmmcamera_target_la_CFLAGS += -DAMSS_VERSION=$(AMSS_VERSION)
@@ -42,7 +21,7 @@ endif
 endif
 if VFE32
 libmmcamera_target_la_CFLAGS += -DVFE_32
-libmmcamera_target_la_CFLAGS += -DFEATURE_GYRO
+#libmmcamera_target_la_CFLAGS += -DFEATURE_GYRO
 endif
 libmmcamera_target_la_CFLAGS += -DIPL_DEBUG_STANDALONE
 libmmcamera_target_la_CFLAGS += -DCHROMATIX_VERSION_$(CHROMATIX_VERSION)
@@ -50,28 +29,46 @@ if FACE_PROC
 libmmcamera_target_la_CFLAGS += -DMM_CAMERA_FD
 endif
 #remove when snapshot is supported
-libmmcamera_target_la_CFLAGS += -DDISABLE_JPEG_ENCODING
+#libmmcamera_target_la_CFLAGS += -DDISABLE_JPEG_ENCODING
 
 #Enable for parallel sensors device
 #libmmcamera_target_la_CFLAGS += -DPARALLEL_SENSOR
 #Enable for Non-ffa devices
 #libmmcamera_target_la_CFLAGS += -DOVERRIDE_SENSOR_SIZE
 
+libmmcamera_target_la_CFLAGS += -DUSE_ION
+if MSM8960
+libmmcamera_target_la_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_CP_MM_HEAP_ID
+else
+libmmcamera_target_la_CFLAGS += -DCAMERA_ION_HEAP_ID=ION_CAMERA_HEAP_ID
+endif
+
+
 
 libmmcamera_target_la_CFLAGS += -I ../common 
-libmmcamera_target_la_CFLAGS += -I core/mctl -I core/config
+libmmcamera_target_la_CFLAGS += -I core -I core/mctl -I core/config
 libmmcamera_target_la_CFLAGS += -I hardware/vfe/vfe_interface
 libmmcamera_target_la_CFLAGS += -I hardware/sensor
-libmmcamera_target_la_CFLAGS += -I hardware/sensor/vx6953
-libmmcamera_target_la_CFLAGS += -I hardware/sensor/s5k4ecgx
-libmmcamera_target_la_CFLAGS += -I hardware/sensor/mt9e013
-libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov9726
-libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov7692
-libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov5647
+libmmcamera_target_la_CFLAGS += -I include
+
 libmmcamera_target_la_CFLAGS += -I hardware/sensor/imx074
 libmmcamera_target_la_CFLAGS += -I hardware/sensor/imx135
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/mt9e013
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/mt9m114
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov2720
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov7692
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov8825
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov9724
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/ov9726
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/s5k3l1yx
+libmmcamera_target_la_CFLAGS += -I hardware/sensor/vx6953
+
+libmmcamera_target_la_CFLAGS += -I hardware/sensor_libs/imx091
 libmmcamera_target_la_CFLAGS += -I hardware/camif
 libmmcamera_target_la_CFLAGS += -I hardware/axi
+libmmcamera_target_la_CFLAGS += -I hardware/csi
+libmmcamera_target_la_CFLAGS += -I hardware/dsps
+libmmcamera_target_la_CFLAGS += -I hardware/vfe/vfe_modules/stats/config
 
 if MSM7X27A
 libmmcamera_target_la_CFLAGS += -I hardware/camif/DSP_CAMIF
@@ -84,6 +81,7 @@ libmmcamera_target_la_CFLAGS += -I hardware/camif/ARM_CAMIF
 libmmcamera_target_la_CFLAGS += -I hardware/axi/ARM_AXI
 endif
 libmmcamera_target_la_CFLAGS += -I hardware/actuator
+libmmcamera_target_la_CFLAGS += -I hardware/actuator/0208
 libmmcamera_target_la_CFLAGS += -I hardware/actuator/$(CHROMATIX_VERSION)
 libmmcamera_target_la_CFLAGS += -I hardware/actuator/$(CHROMATIX_VERSION)/7627a
 libmmcamera_target_la_CFLAGS += -I hardware/actuator/$(CHROMATIX_VERSION)/8960
@@ -92,13 +90,19 @@ libmmcamera_target_la_CFLAGS += -I hardware/eeprom
 libmmcamera_target_la_CFLAGS += -I hardware/flash
 libmmcamera_target_la_CFLAGS += -I hardware/flash/led
 libmmcamera_target_la_CFLAGS += -I hardware/flash/xenon
+libmmcamera_target_la_CFLAGS += -I include
+libmmcamera_target_la_CFLAGS += -I hardware/vfe/vfe_modules/stats/config
+libmmcamera_target_la_CFLAGS += -I hardware/vfe/vfe_modules/stats/parser
 libmmcamera_target_la_CFLAGS += -I hardware/vfe/$(VFE_VERS)/$(MSM_VERSION)
 libmmcamera_target_la_CFLAGS += -I hardware/vfe/$(VFE_VERS)/common
 libmmcamera_target_la_CFLAGS += -I hardware/vfe/$(VFE_VERS)/common/eztune
 libmmcamera_target_la_CFLAGS += -I hardware/vfe/$(VFE_VERS)/test
 libmmcamera_target_la_CFLAGS += -I hardware/vfe/common
-libmmcamera_target_la_CFLAGS += -I hardware/vfe/vfe_modules/fovcrop -I hardware/vfe/vfe_modules/abf  -I hardware/vfe/vfe_modules/asf  -I hardware/vfe/vfe_modules/black_level  -I hardware/vfe/vfe_modules/bpc  -I hardware/vfe/vfe_modules/chroma_enhan  -I hardware/vfe/vfe_modules/chroma_subsample  -I hardware/vfe/vfe_modules/chroma_suppress  -I hardware/vfe/vfe_modules/clamp  -I hardware/vfe/vfe_modules/clf  -I hardware/vfe/vfe_modules/colorcorrect  -I hardware/vfe/vfe_modules/demosaic  -I hardware/vfe/vfe_modules/demux  -I hardware/vfe/vfe_modules/fovcrop  -I hardware/vfe/vfe_modules/frame_skip  -I hardware/vfe/vfe_modules/gamma  -I hardware/vfe/vfe_modules/linearization  -I hardware/vfe/vfe_modules/luma_adaptation  -I hardware/vfe/vfe_modules/mce  -I hardware/vfe/vfe_modules/rolloff -I hardware/vfe/vfe_modules/rolloff/mlro_to_plro -I hardware/vfe/vfe_modules/scaler  -I hardware/vfe/vfe_modules/sce  -I hardware/vfe/vfe_modules/stats -I hardware/vfe/vfe_modules/wb 
+libmmcamera_target_la_CFLAGS += -I hardware/vfe/vfe_modules/fovcrop -I hardware/vfe/vfe_modules/abf  -I hardware/vfe/vfe_modules/asf    -I hardware/vfe/vfe_modules/dsps -I hardware/vfe/vfe_modules/black_level -I hardware/vfe/vfe_modules/bpc  -I hardware/vfe/vfe_modules/chroma_enhan  -I hardware/vfe/vfe_modules/chroma_subsample  -I hardware/vfe/vfe_modules/chroma_suppress  -I hardware/vfe/vfe_modules/clamp  -I hardware/vfe/vfe_modules/clf  -I hardware/vfe/vfe_modules/colorcorrect  -I hardware/vfe/vfe_modules/demosaic  -I hardware/vfe/vfe_modules/demux  -I hardware/vfe/vfe_modules/fovcrop  -I hardware/vfe/vfe_modules/frame_skip  -I hardware/vfe/vfe_modules/gamma  -I hardware/vfe/vfe_modules/linearization  -I hardware/vfe/vfe_modules/luma_adaptation  -I hardware/vfe/vfe_modules/mce  -I hardware/vfe/vfe_modules/rolloff -I hardware/vfe/vfe_modules/rolloff/mlro_to_plro -I hardware/vfe/vfe_modules/scaler  -I hardware/vfe/vfe_modules/sce  -I hardware/vfe/vfe_modules/stats   -I hardware/vfe/vfe_modules/stats/config -I hardware/vfe/vfe_modules/wb
 libmmcamera_target_la_CFLAGS += -I hardware/vpe1
+libmmcamera_target_la_CFLAGS += -I hardware/csi
+libmmcamera_target_la_CFLAGS += -I hardware/csi/csi2/csid
+libmmcamera_target_la_CFLAGS += -I hardware/csi/csi2/csiphy
 libmmcamera_target_la_CFLAGS += -I features/bestshot
 libmmcamera_target_la_CFLAGS += -I features/dis
 libmmcamera_target_la_CFLAGS += -I features/effects
@@ -108,19 +112,33 @@ libmmcamera_target_la_CFLAGS += -I frameproc/hdr
 libmmcamera_target_la_CFLAGS += -I features/stereocam
 libmmcamera_target_la_CFLAGS += -I features/zoom
 libmmcamera_target_la_CFLAGS += -I core/eztune
-libmmcamera_target_la_CFLAGS += -I core/dsps
+libmmcamera_target_la_CFLAGS += -I hardware/dsps
+libmmcamera_target_la_CFLAGS += -I hardware/ispif
 libmmcamera_target_la_CFLAGS += -I frameproc
 libmmcamera_target_la_CFLAGS += -I statsproc
+libmmcamera_target_la_CFLAGS += -I statsproc/is/eis
 libmmcamera_target_la_CFLAGS += -I chromatix/$(CHROMATIX_VERSION)
-#for jpeg
-libmmcamera_target_la_CFLAGS += -I ../../mm-still/ipl/inc
-libmmcamera_target_la_CFLAGS += -I ../../mm-still/jpeg/inc
+libmmcamera_target_la_CFLAGS += -I ${WORKSPACE}/sensors/dsps/api
+libmmcamera_target_la_CFLAGS += -I ${WORKSPACE}/qmi-framework/inc
+libmmcamera_target_la_CFLAGS += -I ${WORKSPACE}/sensors/dsps/libsensor1/inc
 
+#libmmcamera_target_la_CFLAGS += -I ${WORKSPACE}/camera-hal
+
+#for jpeg
+libmmcamera_target_la_CFLAGS += -I $(MM_STILL_PATH)/ipl/inc
+if MSM7X27A
+libmmcamera_target_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libmmcamera_target_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
 libmmcamera_target_la_SOURCES := ../common/cam_mmap.c
 libmmcamera_target_la_SOURCES += ../common/stacktrace.c
 
 #add core framework
 libmmcamera_target_la_SOURCES += core/qcamsvr.c
+libmmcamera_target_la_SOURCES += core/config/config_interface.c
+libmmcamera_target_la_SOURCES += core/config/config_v2.c
 libmmcamera_target_la_SOURCES += core/config/config.c
 libmmcamera_target_la_SOURCES += core/config/config_pp.c
 libmmcamera_target_la_SOURCES += core/config/config_proc.c
@@ -136,8 +154,8 @@ libmmcamera_target_la_SOURCES += core/mctl/mctl_pp_vpe_cmd.c
 libmmcamera_target_la_SOURCES += core/mctl/mctl_ez.c
 libmmcamera_target_la_SOURCES += core/mctl/mctl_af.c
 libmmcamera_target_la_SOURCES += core/mctl/mctl_proc.c
-libmmcamera_target_la_SOURCES += core/dsps/dsps.c
-libmmcamera_target_la_SOURCES += core/dsps/dsps_interface.c
+libmmcamera_target_la_SOURCES += core/mctl/mctl_divert.c
+libmmcamera_target_la_SOURCES += core/mctl/mctl_mobicat.c
 libmmcamera_target_la_SOURCES += core/eztune/eztune.c
 libmmcamera_target_la_SOURCES += core/eztune/eztune_items_0208.c
 libmmcamera_target_la_SOURCES += core/eztune/eztune_preview.c
@@ -191,23 +209,26 @@ libmmcamera_target_la_SOURCES += hardware/actuator/actuator_interface.c
 libmmcamera_target_la_SOURCES += hardware/c2d_client/c2d_client.c
 
 #add sensor
-libmmcamera_target_la_SOURCES += hardware/sensor/imx074/imx074_u.c
-libmmcamera_target_la_SOURCES += hardware/sensor/imx135/imx135_u.c
 libmmcamera_target_la_SOURCES += hardware/sensor/sensor_util.c
 libmmcamera_target_la_SOURCES += hardware/sensor/sensor_interface.c
-libmmcamera_target_la_SOURCES += hardware/sensor/ov2720/ov2720_u.c
 libmmcamera_target_la_SOURCES += hardware/sensor/sensor.c
-libmmcamera_target_la_SOURCES += hardware/sensor/vx6953/vx6953_u.c
-libmmcamera_target_la_SOURCES += hardware/sensor/s5k4e1/s5k4e1_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/imx074/imx074_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/imx135/imx135_u.c
 libmmcamera_target_la_SOURCES += hardware/sensor/mt9e013/mt9e013_u.c
-libmmcamera_target_la_SOURCES += hardware/sensor/ov9726/ov9726_u.c
-libmmcamera_target_la_SOURCES += hardware/sensor/ov7692/ov7692_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/ov2720/ov2720_u.c
 libmmcamera_target_la_SOURCES += hardware/sensor/ov5647/ov5647_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/ov7692/ov7692_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/ov8825/ov8825_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/ov9724/ov9724_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/ov9726/ov9726_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/s5k4e1/s5k4e1_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/vx6953/vx6953_u.c
 
 #add vfe
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_interface/vfe_interface.c
 
 libmmcamera_target_la_SOURCES += hardware/vfe/$(VFE_VERS)/common/vfe.c
+libmmcamera_target_la_SOURCES += hardware/vfe/$(VFE_VERS)/common/vfe_diag.c
 
 if VFE_TEST_VEC
 libmmcamera_target_la_SOURCES += hardware/vfe/$(VFE_VERS)/test/vfe_test_vector.c
@@ -235,34 +256,82 @@ libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/asf/asf.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/rolloff.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/mesh_rolloff.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/pca_rolloff.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/tintless_interface.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/mlro_to_plro/mlro.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/mlro_to_plro/mlro_utils.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/mlro_to_plro/matrix_utils.c
 
 if VFE32
+libmmcamera_target_la_CFLAGS += -I./hardware/vfe/vfe_modules/stats/config
+libmmcamera_target_la_SOURCES += hardware/dsps/dsps_hw.c
+libmmcamera_target_la_SOURCES += hardware/dsps/dsps_hw_interface.c
+libmmcamera_target_la_SOURCES += hardware/csi/csi2/csi.c
+libmmcamera_target_la_SOURCES += hardware/csi/csi_interface.c
+libmmcamera_target_la_SOURCES += hardware/csi/csi2/csid/csid.c
+libmmcamera_target_la_SOURCES += hardware/csi/csi2/csiphy/csiphy.c
+libmmcamera_target_la_SOURCES += hardware/sensor/s5k3l1yx/s5k3l1yx_u.c
+#libmmcamera_target_la_SOURCES += hardware/sensor/imx175/imx175_u.c
+libmmcamera_target_la_SOURCES += hardware/sensor/mt9m114/mt9m114_u.c
+libmmcamera_target_la_SOURCES += hardware/ispif/ispif_interface.c
+libmmcamera_target_la_SOURCES += hardware/ispif/ispif.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/abf/abf_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/asf/asf_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/bpc/bpc_v3_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/bpc/bcc_v3_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/chroma_enhan/chroma_enhan_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/chroma_subsample/chroma_subsample_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/chroma_suppress/chroma_suppress_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/clamp/clamp_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/clf/clf_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/colorcorrect/colorcorrect_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/demosaic/demosaic_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/demux/demux_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/fovcrop/fovcrop_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/frame_skip/frame_skip_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/gamma/gamma_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/luma_adaptation/luma_adaptation_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/mce/mce_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/rolloff_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/rolloff/mesh_rolloff_v4.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/scaler/scaler_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/sce/sce_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/wb/wb_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/aec_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/af_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/awb_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/be_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/bf_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/bg_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/bhist_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/ihist_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/rs_cs_stats_intf.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/frame_skip/frame_skip.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/demosaic/demosaic_v3.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/bpc/bcc_v3.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/bpc/bpc_v3.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/linearization/linearization_v1.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/clf/clf.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/bg_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/bf_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/bhist_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/bg_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/bf_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/be_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/bhist_stats.c
+#libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/af_stats_intf.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/linearization/linearization_intf.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/mce/mce.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/chroma_suppress/chroma_suppress.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/sce/sce.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/luma_adaptation/luma_adaptation.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/rs_cs_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/ihist_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/rs_cs_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/ihist_stats.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/scaler/scaler.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/aec_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/af_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/awb_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/aec_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/af_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/awb_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/parser/stats_parser.c
 else 
 if VFE2X
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/aec_awb_7x27a.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/af_7x27a.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/aec_awb_7x27a.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/af_7x27a.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/demosaic/demosaic_v3.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/black_level/black_level_v1.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/bpc/bpc_v3_7x27a.c
@@ -279,12 +348,12 @@ libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/mce/mce.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/chroma_suppress/chroma_suppress.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/sce/sce.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/luma_adaptation/luma_adaptation.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/rs_cs_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/ihist_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/rs_cs_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/ihist_stats.c
 libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/scaler/scaler.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/aec_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/af_stats.c
-libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/awb_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/aec_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/af_stats.c
+libmmcamera_target_la_SOURCES += hardware/vfe/vfe_modules/stats/config/awb_stats.c
 endif
 endif
 
@@ -307,11 +376,15 @@ libmmcamera_statsproc31_la_CFLAGS += -DMSM_CAMERA_GCC
 libmmcamera_statsproc31_la_CFLAGS += -DLINUX_ENABLED
 libmmcamera_statsproc31_la_CFLAGS += -D_V4L2_BASED_CAM_
 #remove when snapshot is supported
-libmmcamera_statsproc31_la_CFLAGS += -DDISABLE_JPEG_ENCODING
-
+#libmmcamera_statsproc31_la_CFLAGS += -DDISABLE_JPEG_ENCODING
+libmmcamera_statsproc31_la_CFLAGS += -DUSE_ION
 libmmcamera_statsproc31_la_CFLAGS += -I ../common
 libmmcamera_statsproc31_la_CFLAGS += -I statsproc/aec
 libmmcamera_statsproc31_la_CFLAGS += -I statsproc
+libmmcamera_statsproc31_la_CFLAGS += -I statsproc/is/dis
+libmmcamera_statsproc31_la_CFLAGS += -I statsproc/is/eis
+libmmcamera_statsproc31_la_CFLAGS += -I include
+libmmcamera_statsproc31_la_CFLAGS += -I hardware/actuator/0208
 libmmcamera_statsproc31_la_CFLAGS += -I chromatix/$(CHROMATIX_VERSION)
 
 libmmcamera_statsproc31_la_SOURCES := statsproc/stats_proc.c
@@ -331,13 +404,17 @@ libmmcamera_statsproc31_la_SOURCES += statsproc/af/af_interface.c
 libmmcamera_statsproc31_la_SOURCES += statsproc/af/af_util.c
 libmmcamera_statsproc31_la_SOURCES += statsproc/af/af.c
 libmmcamera_statsproc31_la_SOURCES += statsproc/af/af_exhstv.c
+libmmcamera_statsproc31_la_SOURCES += statsproc/af/af_cont.c
 libmmcamera_statsproc31_la_SOURCES += statsproc/af/af_hillclimb.c
 libmmcamera_statsproc31_la_SOURCES += statsproc/af/af_slopepredictive.c
-libmmcamera_statsproc31_la_SOURCES += statsproc/dis/dis_interface.c
-libmmcamera_statsproc31_la_SOURCES += statsproc/dis/dis.c
+libmmcamera_statsproc31_la_SOURCES += statsproc/is/dis/dis_interface.c
+libmmcamera_statsproc31_la_SOURCES += statsproc/is/eis/eis_interface.c
+libmmcamera_statsproc31_la_SOURCES += statsproc/is/is_interface.c
 libmmcamera_statsproc31_la_SOURCES += statsproc/afd/afd_interface.c
 libmmcamera_statsproc31_la_SOURCES += statsproc/afd/afd.c
 
+libmmcamera_statsproc31_la_LIBADD = -lmmcamera_image_stab
+
 libmmcamera_statsproc31_la_LDFLAGS := $(DEBUG_LDFLAGS)
 libmmcamera_statsproc31_la_LDFLAGS += -shared
 
@@ -351,7 +428,7 @@ libmmcamera_frameproc_la_CFLAGS += -D_GNU_SOURCE
 libmmcamera_frameproc_la_CFLAGS += -DLINUX_ENABLED
 libmmcamera_frameproc_la_CFLAGS += -D_V4L2_BASED_CAM_
 #remove when snapshot is supported
-libmmcamera_frameproc_la_CFLAGS += -DDISABLE_JPEG_ENCODING
+#libmmcamera_frameproc_la_CFLAGS += -DDISABLE_JPEG_ENCODING
 if WAVELET_DENOISE
 libmmcamera_frameproc_la_CFLAGS += -DMM_CAMERA_NEON_ENABLED
 endif
@@ -359,20 +436,29 @@ if FACE_PROC
 libmmcamera_frameproc_la_CFLAGS += -DMM_CAMERA_FD
 endif
 
-libmmcamera_frameproc_la_CFLAGS += -I ../common -I chromatix/$(CHROMATIX_VERSION) -I frameproc
+libmmcamera_frameproc_la_CFLAGS += -I ../common -I chromatix/$(CHROMATIX_VERSION) -I frameproc -I include
 libmmcamera_frameproc_la_CFLAGS += -I frameproc/face_proc/engine
+libmmcamera_frameproc_la_CFLAGS += -I hardware/vfe/vfe_modules/stats/config
 #for jpeg
-libmmcamera_frameproc_la_CFLAGS += -I ../../mm-still/ipl/inc
-libmmcamera_frameproc_la_CFLAGS += -I ../../mm-still/jpeg/inc
+libmmcamera_frameproc_la_CFLAGS += -I $(MM_STILL_PATH)/ipl/inc
+if MSM7X27A
+libmmcamera_frameproc_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libmmcamera_frameproc_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
+libmmcamera_frameproc_la_CFLAGS += -I frameproc/hdr
+if WAVELET_DENOISE
+libmmcamera_frameproc_la_CFLAGS += -I frameproc/wavelet_denoise
+endif
 
 libmmcamera_frameproc_la_SOURCES := frameproc/hjr/hjr_interface.c
 libmmcamera_frameproc_la_SOURCES += frameproc/hjr/hjr.c
+if WAVELET_DENOISE
 libmmcamera_frameproc_la_SOURCES += frameproc/wavelet_denoise/wavelet_denoise_interface.c
-libmmcamera_frameproc_la_SOURCES += frameproc/wavelet_denoise/wavelet_denoise.c
+#libmmcamera_frameproc_la_SOURCES += frameproc/wavelet_denoise/wavelet_denoise_chroma.c
+endif
 libmmcamera_frameproc_la_SOURCES += frameproc/hdr/hdr_interface.c
-libmmcamera_frameproc_la_SOURCES += frameproc/hdr/hdr_util.c
-libmmcamera_frameproc_la_SOURCES += frameproc/hdr/hdrsingleframe.c
-libmmcamera_frameproc_la_SOURCES += frameproc/hdr/hdrtwoframe.c
 if FACE_PROC
 libmmcamera_frameproc_la_SOURCES += frameproc/frameproc.c
 libmmcamera_frameproc_la_SOURCES += frameproc/face_proc/face_proc_interface.c
@@ -382,14 +468,52 @@ endif
 
 libmmcamera_frameproc_la_LDFLAGS := $(DEBUG_LDFLAGS)
 libmmcamera_frameproc_la_LDFLAGS += -shared
+
 if WAVELET_DENOISE
-libmmcamera_frameproc_la_LIBADD = libmmcamera_server_assembly.la
-libmmcamera_frameproc_la_LIBADD += -ldl
+libmmcamera_frameproc_la_LIBADD = -ldl
+libmmcamera_frameproc_la_LIBADD += frameproc/face_proc/engine/libmmcamera_faceproc.so
+libmmcamera_frameproc_la_LIBADD += -lmmcamera_wavelet_lib
+libmmcamera_frameproc_la_LIBADD += -lmmcamera_hdr_lib
 endif
 
+#libmmcamera_plugin
+lib_LTLIBRARIES += libmmcamera_plugin.la
+
+libmmcamera_plugin_la_CFLAGS := $(DEBUG_CFLAGS)
+libmmcamera_plugin_la_CFLAGS += -DAMSS_VERSION=$(AMSS_VERSION)
+libmmcamera_plugin_la_CFLAGS += -DMSM_CAMERA_GCC
+libmmcamera_plugin_la_CFLAGS += -DLINUX_ENABLED
+libmmcamera_plugin_la_CFLAGS += -D_V4L2_BASED_CAM_
+#remove when snapshot is supported
+#libmmcamera_plugin_la_CFLAGS += -DDISABLE_JPEG_ENCODING
+libmmcamera_plugin_la_CFLAGS += -DUSE_ION
+libmmcamera_plugin_la_CFLAGS += -I ../common
+#libmmcamera_plugin_la_CFLAGS += -I statsproc/aec
+#libmmcamera_plugin_la_CFLAGS += -I statsproc
+#libmmcamera_plugin_la_CFLAGS += -I statsproc/is/dis
+#libmmcamera_plugin_la_CFLAGS += -I statsproc/is/eis
+libmmcamera_plugin_la_CFLAGS += -I include
+#libmmcamera_plugin_la_CFLAGS += -I hardware/actuator/0208
+libmmcamera_plugin_la_CFLAGS += -I chromatix/$(CHROMATIX_VERSION)
+libmmcamera_plugin_la_CFLAGS += -I plugin
+libmmcamera_plugin_la_CFLAGS += -I hardware/vfe/vfe_interface
+libmmcamera_plugin_la_CFLAGS += -I hardware/vfe/common 
+libmmcamera_plugin_la_CFLAGS += -I hardware/vfe/$(VFE_VERS)/$(MSM_VERSION)
+libmmcamera_plugin_la_CFLAGS += -I hardware/vfe/$(VFE_VERS)/common
+libmmcamera_plugin_la_CFLAGS += -I hardware/vfe/$(VFE_VERS)/test
+libmmcamera_plugin_la_CFLAGS += -I hardware/vfe/vfe_modules/fovcrop -I hardware/vfe/vfe_modules/abf  -I hardware/vfe/vfe_modules/asf    -I hardware/vfe/vfe_modules/dsps -I hardware/vfe/vfe_modules/black_level  -I hardware/vfe/vfe_modules/bpc  -I hardware/vfe/vfe_modules/chroma_enhan  -I hardware/vfe/vfe_modules/chroma_subsample  -I hardware/vfe/vfe_modules/chroma_suppress  -I hardware/vfe/vfe_modules/clamp  -I hardware/vfe/vfe_modules/clf  -I hardware/vfe/vfe_modules/colorcorrect  -I hardware/vfe/vfe_modules/demosaic  -I hardware/vfe/vfe_modules/demux  -I hardware/vfe/vfe_modules/fovcrop  -I hardware/vfe/vfe_modules/frame_skip  -I hardware/vfe/vfe_modules/gamma  -I hardware/vfe/vfe_modules/linearization  -I hardware/vfe/vfe_modules/luma_adaptation  -I hardware/vfe/vfe_modules/mce  -I hardware/vfe/vfe_modules/rolloff -I hardware/vfe/vfe_modules/rolloff/mlro_to_plro -I hardware/vfe/vfe_modules/scaler  -I hardware/vfe/vfe_modules/sce  -I hardware/vfe/vfe_modules/stats   -I hardware/vfe/vfe_modules/stats/config -I hardware/vfe/vfe_modules/wb
+libmmcamera_plugin_la_SOURCES := plugin/camera_plugin.c
+
+libmmcamera_plugin_la_LDFLAGS := $(DEBUG_LDFLAGS)
+libmmcamera_plugin_la_LDFLAGS += -shared
+
 dirs :=
 
 if ARM
+dirs += chromatix/0208/libchromatix/chromatix_ov2720/preview
+dirs += chromatix/0208/libchromatix/chromatix_s5k3l1yx/preview
+dirs += chromatix/0208/libchromatix/chromatix_s5k3l1yx/video
+dirs += chromatix/0208/libchromatix/chromatix_s5k3l1yx/zsl
 dirs += chromatix/0208/libchromatix/chromatix_vx6953/preview
 dirs += chromatix/0208/libchromatix/chromatix_vx6953/video
 dirs += chromatix/0208/libchromatix/chromatix_s5k4e1/preview
diff --git a/server/chromatix/0208/libchromatix/chromatix_ov2720/preview/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_ov2720/preview/Makefile.am
new file mode 100644
index 0000000..28c6cac
--- /dev/null
+++ b/server/chromatix/0208/libchromatix/chromatix_ov2720/preview/Makefile.am
@@ -0,0 +1,32 @@
+
+#libchromatix_ov2720_preview.so
+lib_LTLIBRARIES := libchromatix_ov2720_preview.la
+
+libchromatix_ov2720_preview_la_CFLAGS := $(DEBUG_CFLAGS)
+libchromatix_ov2720_preview_la_CFLAGS += -DMSM_CAMERA_GCC
+libchromatix_ov2720_preview_la_CFLAGS += -D_GNU_SOURCE
+libchromatix_ov2720_preview_la_CFLAGS += -DLINUX_ENABLED
+libchromatix_ov2720_preview_la_CFLAGS += -fPIC
+
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../..
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../../../..
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../../../../hardware/sensor
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../../../../include
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../../../../hardware/flash
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../../../../hardware/flash/xenon
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../../../../isp3a
+libchromatix_ov2720_preview_la_CFLAGS += -I ../../../../../../common
+
+#for jpeg
+if MSM7X27A
+libchromatix_ov2720_preview_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_ov2720_preview_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
+
+libchromatix_ov2720_preview_la_SOURCES := chromatix_ov2720_preview.c
+
+libchromatix_ov2720_preview_la_LDFLAGS := $(DEBUG_LDFLAGS)
+libchromatix_ov2720_preview_la_LDFLAGS += -shared
+
diff --git a/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/preview/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/preview/Makefile.am
new file mode 100644
index 0000000..892c0c1
--- /dev/null
+++ b/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/preview/Makefile.am
@@ -0,0 +1,32 @@
+
+#libchromatix_s5k3l1yx_preview.so
+lib_LTLIBRARIES := libchromatix_s5k3l1yx_preview.la
+
+libchromatix_s5k3l1yx_preview_la_CFLAGS := $(DEBUG_CFLAGS)
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -DMSM_CAMERA_GCC
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -D_GNU_SOURCE
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -DLINUX_ENABLED
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -fPIC
+
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../..
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../../../..
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../../../../hardware/sensor
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../../../../include
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../../../../hardware/flash
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../../../../hardware/flash/xenon
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../../../../isp3a
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I ../../../../../../common
+
+#for jpeg
+if MSM7X27A
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_s5k3l1yx_preview_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
+
+libchromatix_s5k3l1yx_preview_la_SOURCES := chromatix_s5k3l1yx_preview.c
+
+libchromatix_s5k3l1yx_preview_la_LDFLAGS := $(DEBUG_LDFLAGS)
+libchromatix_s5k3l1yx_preview_la_LDFLAGS += -shared
+
diff --git a/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/video/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/video/Makefile.am
new file mode 100644
index 0000000..1ee9b92
--- /dev/null
+++ b/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/video/Makefile.am
@@ -0,0 +1,32 @@
+
+#libchromatix_s5k3l1yx_default_video.so
+lib_LTLIBRARIES := libchromatix_s5k3l1yx_default_video.la
+
+libchromatix_s5k3l1yx_default_video_la_CFLAGS := $(DEBUG_CFLAGS)
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -DMSM_CAMERA_GCC
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -D_GNU_SOURCE
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -DLINUX_ENABLED
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -fPIC
+
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../..
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../../../..
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../../../../hardware/sensor
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../../../../include
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../../../../hardware/flash
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../../../../hardware/flash/xenon
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../../../../isp3a
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I ../../../../../../common
+
+#for jpeg
+if MSM7X27A
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_s5k3l1yx_default_video_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
+
+libchromatix_s5k3l1yx_default_video_la_SOURCES := chromatix_s5k3l1yx_video.c
+
+libchromatix_s5k3l1yx_default_video_la_LDFLAGS := $(DEBUG_LDFLAGS)
+libchromatix_s5k3l1yx_default_video_la_LDFLAGS += -shared
+
diff --git a/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/zsl/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/zsl/Makefile.am
new file mode 100644
index 0000000..8c880b9
--- /dev/null
+++ b/server/chromatix/0208/libchromatix/chromatix_s5k3l1yx/zsl/Makefile.am
@@ -0,0 +1,32 @@
+
+#libchromatix_s5k3l1yx_zsl.so
+lib_LTLIBRARIES := libchromatix_s5k3l1yx_zsl.la
+
+libchromatix_s5k3l1yx_zsl_la_CFLAGS := $(DEBUG_CFLAGS)
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -DMSM_CAMERA_GCC
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -D_GNU_SOURCE
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -DLINUX_ENABLED
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -fPIC
+
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../..
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../../../..
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../../../../hardware/sensor
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../../../../include
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../../../../hardware/flash
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../../../../hardware/flash/xenon
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../../../../isp3a
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I ../../../../../../common
+
+#for jpeg
+if MSM7X27A
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_s5k3l1yx_zsl_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
+
+libchromatix_s5k3l1yx_zsl_la_SOURCES := chromatix_s5k3l1yx_zsl.c
+
+libchromatix_s5k3l1yx_zsl_la_LDFLAGS := $(DEBUG_LDFLAGS)
+libchromatix_s5k3l1yx_zsl_la_LDFLAGS += -shared
+
diff --git a/server/chromatix/0208/libchromatix/chromatix_s5k4e1/preview/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_s5k4e1/preview/Makefile.am
index e3d4e10..53a78dc 100644
--- a/server/chromatix/0208/libchromatix/chromatix_s5k4e1/preview/Makefile.am
+++ b/server/chromatix/0208/libchromatix/chromatix_s5k4e1/preview/Makefile.am
@@ -8,15 +8,21 @@ libchromatix_s5k4e1_preview_la_CFLAGS += -D_GNU_SOURCE
 libchromatix_s5k4e1_preview_la_CFLAGS += -DLINUX_ENABLED
 libchromatix_s5k4e1_preview_la_CFLAGS += -fPIC
 
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../..
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../../../..
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../../../../hardware/sensor
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../../../../hardware/flash
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../../../../hardware/flash/xenon
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../../../../isp3a
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../../../../../common
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../..
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../../../..
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../../../../hardware/sensor
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../../../../include
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../../../../hardware/flash
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../../../../hardware/flash/xenon
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../../../../isp3a
+libchromatix_s5k4e1_preview_la_CFLAGS += -I../../../../../../common
 #for jpeg
-libchromatix_s5k4e1_preview_la_CFLAGS += -I ../../../../../../../mm-still/jpeg/inc
+if MSM7X27A
+libchromatix_s5k4e1_preview_la_CFLAGS += -I$(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_s5k4e1_preview_la_CFLAGS += -I$(MM_STILL_PATH)/jpeg2/inc
+endif
 
 libchromatix_s5k4e1_preview_la_SOURCES := chromatix_s5k4e1_preview.c
 
diff --git a/server/chromatix/0208/libchromatix/chromatix_s5k4e1/video/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_s5k4e1/video/Makefile.am
index baca9a4..6dd2a31 100644
--- a/server/chromatix/0208/libchromatix/chromatix_s5k4e1/video/Makefile.am
+++ b/server/chromatix/0208/libchromatix/chromatix_s5k4e1/video/Makefile.am
@@ -8,15 +8,21 @@ libchromatix_s5k4e1_default_video_la_CFLAGS += -D_GNU_SOURCE
 libchromatix_s5k4e1_default_video_la_CFLAGS += -DLINUX_ENABLED
 libchromatix_s5k4e1_default_video_la_CFLAGS += -fPIC
 
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../..
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../../../..
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../../../../hardware/sensor
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../../../../hardware/flash
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../../../../hardware/flash/xenon
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../../../../isp3a
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../../../../../common
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../..
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../../../..
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../../../../hardware/sensor
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../../../../include
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../../../../hardware/flash
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../../../../hardware/flash/xenon
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../../../../isp3a
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I../../../../../../common
 #for jpeg
-libchromatix_s5k4e1_default_video_la_CFLAGS += -I ../../../../../../../mm-still/jpeg/inc
+if MSM7X27A
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_s5k4e1_default_video_la_CFLAGS += -I $(MM_STILL_PATH)/jpeg2/inc
+endif
 
 libchromatix_s5k4e1_default_video_la_SOURCES := chromatix_s5k4e1_video.c
 
diff --git a/server/chromatix/0208/libchromatix/chromatix_vx6953/preview/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_vx6953/preview/Makefile.am
index d9a2bad..973b8d3 100644
--- a/server/chromatix/0208/libchromatix/chromatix_vx6953/preview/Makefile.am
+++ b/server/chromatix/0208/libchromatix/chromatix_vx6953/preview/Makefile.am
@@ -8,15 +8,21 @@ libchromatix_vx6953_preview_la_CFLAGS += -D_GNU_SOURCE
 libchromatix_vx6953_preview_la_CFLAGS += -DLINUX_ENABLED
 libchromatix_vx6953_preview_la_CFLAGS += -fPIC
 
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../..
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../../../..
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../../../../hardware/sensor
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../../../../hardware/flash
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../../../../hardware/flash/xenon
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../../../../isp3a
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../../../../../common
+libchromatix_vx6953_preview_la_CFLAGS += -I../../..
+libchromatix_vx6953_preview_la_CFLAGS += -I../../../../..
+libchromatix_vx6953_preview_la_CFLAGS += -I../../../../../hardware/sensor
+libchromatix_vx6953_preview_la_CFLAGS += -I../../../../../include
+libchromatix_vx6953_preview_la_CFLAGS += -I../../../../../hardware/flash
+libchromatix_vx6953_preview_la_CFLAGS += -I../../../../../hardware/flash/xenon
+libchromatix_vx6953_preview_la_CFLAGS += -I../../../../../isp3a
+libchromatix_vx6953_preview_la_CFLAGS += -I../../../../../../common
 #for jpeg
-libchromatix_vx6953_preview_la_CFLAGS += -I ../../../../../../../mm-still/jpeg/inc
+if MSM7X27A
+libchromatix_vx6953_preview_la_CFLAGS += -I$(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_vx6953_preview_la_CFLAGS += -I$(MM_STILL_PATH)/jpeg2/inc
+endif
 
 libchromatix_vx6953_preview_la_SOURCES := chromatix_vx6953_preview.c
 
diff --git a/server/chromatix/0208/libchromatix/chromatix_vx6953/video/Makefile.am b/server/chromatix/0208/libchromatix/chromatix_vx6953/video/Makefile.am
index 299ad5c..ff06e1c 100644
--- a/server/chromatix/0208/libchromatix/chromatix_vx6953/video/Makefile.am
+++ b/server/chromatix/0208/libchromatix/chromatix_vx6953/video/Makefile.am
@@ -8,16 +8,21 @@ libchromatix_vx6953_default_video_la_CFLAGS += -D_GNU_SOURCE
 libchromatix_vx6953_default_video_la_CFLAGS += -DLINUX_ENABLED
 libchromatix_vx6953_default_video_la_CFLAGS += -fPIC
 
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../..
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../../../..
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../../../../hardware/sensor
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../../../../hardware/flash
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../../../../hardware/flash/xenon
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../../../../isp3a
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../../../../../common
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../..
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../../../..
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../../../../hardware/sensor
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../../../../include
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../../../../hardware/flash
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../../../../hardware/flash/xenon
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../../../../isp3a
+libchromatix_vx6953_default_video_la_CFLAGS += -I../../../../../../common
 #for jpeg
-libchromatix_vx6953_default_video_la_CFLAGS += -I ../../../../../../../mm-still/jpeg/inc
-
+if MSM7X27A
+libchromatix_vx6953_default_video_la_CFLAGS += -I$(MM_STILL_PATH)/jpeg/inc
+endif
+if MSM8960
+libchromatix_vx6953_default_video_la_CFLAGS += -I$(MM_STILL_PATH)/jpeg2/inc
+endif
 libchromatix_vx6953_default_video_la_SOURCES := chromatix_vx6953_video.c
 
 libchromatix_vx6953_default_video_la_LDFLAGS := $(DEBUG_LDFLAGS)
-- 
1.8.2.1

