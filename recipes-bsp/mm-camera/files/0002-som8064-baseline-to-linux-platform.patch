From 03530655faec167ae842d0d1b72632cc137121e7 Mon Sep 17 00:00:00 2001
From: Kaustubh Gondkar <kgondkar@qti.qualcomm.com>
Date: Tue, 17 Jun 2014 21:10:57 -0700
Subject: [PATCH] porting to linux platform

Change-Id: I8f73dc9486d0d28f96165ecf3529696f66381b2d
---
 common/camera.h                                            |  2 +-
 server/core/config/config.c                                |  1 +
 server/core/config/config_interface.h                      |  3 ++-
 server/core/config/config_proc.h                           |  1 +
 server/core/config/config_proc_ctrlcmd.c                   |  1 +
 server/core/config/config_v2.c                             |  1 +
 server/core/eztune/eztune_preview.c                        |  1 +
 server/core/mctl/mctl.c                                    | 11 ++++++++++-
 server/core/mctl/mctl_divert.c                             |  9 ++++++++-
 server/core/mctl/mctl_proc.c                               |  1 +
 server/features/hdr/hdr.c                                  |  1 +
 server/features/live_snapshot/live_snapshot.c              |  3 +++
 server/features/zoom/zoom.c                                |  1 +
 server/frameproc/face_proc/face_proc_util.c                |  2 ++
 server/frameproc/frameproc.c                               |  3 +++
 server/frameproc/hdr/hdr.h                                 |  5 ++++-
 server/frameproc/hdr/hdr_interface.c                       |  2 ++
 .../frameproc/wavelet_denoise/wavelet_denoise_interface.c  |  1 +
 server/hardware/actuator/0208/af_tuning.h                  |  3 ++-
 server/hardware/actuator/actuator.c                        |  1 +
 server/hardware/actuator/actuator_interface.c              |  1 +
 server/hardware/axi/ARM_AXI/axi.c                          |  6 ++++--
 server/hardware/axi/axi_interface.c                        |  2 ++
 server/hardware/c2d_client/c2d_client.c                    |  5 +++++
 server/hardware/camif/ARM_CAMIF/camif.c                    |  1 +
 server/hardware/camif/camif_interface.c                    |  1 +
 server/hardware/csi/csi2/csi.c                             |  1 +
 server/hardware/csi/csi_interface.c                        |  2 ++
 server/hardware/dsps/dsps_hw.h                             |  1 +
 server/hardware/eeprom/eeprom_interface.c                  |  2 ++
 server/hardware/ispif/ispif_interface.c                    |  2 ++
 server/hardware/sensor/imx135/imx135_u.c                   |  1 +
 server/hardware/sensor/sensor.c                            |  1 +
 server/hardware/sensor/sensor.h                            |  1 +
 server/hardware/sensor/sensor_interface.c                  |  1 +
 server/hardware/sensor/sensor_util.c                       |  2 ++
 server/hardware/vfe/vfe32/8960/vfe_tgtcommon.h             |  2 ++
 server/hardware/vfe/vfe32/common/vfe.c                     |  4 +++-
 server/hardware/vfe/vfe32/common/vfe.h                     |  1 +
 server/hardware/vfe/vfe_interface/vfe_interface.c          |  2 +-
 server/hardware/vfe/vfe_interface/vfe_interface.h          |  1 +
 server/hardware/vfe/vfe_modules/clamp/clamp_intf.c         |  1 +
 server/hardware/vfe/vfe_modules/rolloff/pca_rolloff.c      | 13 +++++++++++++
 server/hardware/vfe/vfe_modules/rolloff/rolloff.c          |  1 +
 server/hardware/vfe/vfe_modules/stats/config/aec_stats.c   |  1 +
 server/hardware/vfe/vfe_modules/stats/config/af_stats.c    |  1 +
 server/hardware/vfe/vfe_modules/stats/config/awb_stats.c   |  1 +
 server/hardware/vfe/vfe_modules/stats/config/be_stats.c    |  1 +
 .../hardware/vfe/vfe_modules/stats/config/be_stats_intf.c  |  1 +
 .../hardware/vfe/vfe_modules/stats/parser/stats_parser.c   |  1 +
 server/hardware/vpe1/vpe.c                                 | 14 +++++++++++++-
 server/include/tgtcommon.h                                 |  1 +
 server/statsproc/stats_proc.c                              |  4 ++--
 53 files changed, 120 insertions(+), 13 deletions(-)

diff --git a/common/camera.h b/common/camera.h
index bd0e5d2..dbafe42 100644
--- a/common/camera.h
+++ b/common/camera.h
@@ -15,7 +15,7 @@
 #endif
 #include <poll.h>
 #include <linux/videodev2.h>
-#include "jpege.h"
+/*#include "jpege.h"*/
 //#include "exif.h"
 #include "camera_defs_i.h"
 #include "QCamera_Intf.h"
diff --git a/server/core/config/config.c b/server/core/config/config.c
index d74afbc..c88515c 100755
--- a/server/core/config/config.c
+++ b/server/core/config/config.c
@@ -14,6 +14,7 @@
 #include <inttypes.h>
 #include <media/msm_isp.h>
 #include <assert.h>
+#include <stdbool.h>
 
 #include "camera_dbg.h"
 #include "camera.h"
diff --git a/server/core/config/config_interface.h b/server/core/config/config_interface.h
index 8705bd2..b6ea2fa 100644
--- a/server/core/config/config_interface.h
+++ b/server/core/config/config_interface.h
@@ -3,7 +3,8 @@
    Qualcomm Technologies Proprietary and Confidential.
 ============================================================================*/
 #ifndef __CONFIG_INTERFACE_H__
-
+#include <stdint.h>
+#include <inttypes.h>
 struct config_interface_t {
   int (*config_request)(void *parm1, void *parm2, int *cmdPending);
   int (*config_proc_event_message)(void *parm1, void *parm2);
diff --git a/server/core/config/config_proc.h b/server/core/config/config_proc.h
index 3b127e9..4579570 100755
--- a/server/core/config/config_proc.h
+++ b/server/core/config/config_proc.h
@@ -4,6 +4,7 @@
 ============================================================================*/
 #ifndef __CONFIG_PROC_H__
 #define __CONFIG_PROC_H__
+#include <stdint.h>
 
 /* ToDo: Don't know where to put this code. */
 int config_proc_send_zoom_done_event(void *parm1, void *parm2); /*config_proc.c*/
diff --git a/server/core/config/config_proc_ctrlcmd.c b/server/core/config/config_proc_ctrlcmd.c
index e41ab2d..d667f29 100644
--- a/server/core/config/config_proc_ctrlcmd.c
+++ b/server/core/config/config_proc_ctrlcmd.c
@@ -8,6 +8,7 @@
 #include <linux/v4l2-mediabus.h>
 #include <string.h>
 #include <unistd.h>
+#include <stdbool.h>
 #ifdef _ANDROID_
 #include <utils/Log.h>
 #endif
diff --git a/server/core/config/config_v2.c b/server/core/config/config_v2.c
index 1a24af4..4a39abb 100644
--- a/server/core/config/config_v2.c
+++ b/server/core/config/config_v2.c
@@ -14,6 +14,7 @@
 #include <inttypes.h>
 #include <media/msm_isp.h>
 #include <assert.h>
+#include <stdbool.h>
 
 #include "camera_dbg.h"
 #include "camera.h"
diff --git a/server/core/eztune/eztune_preview.c b/server/core/eztune/eztune_preview.c
index 92aaaf8..6be8df7 100644
--- a/server/core/eztune/eztune_preview.c
+++ b/server/core/eztune/eztune_preview.c
@@ -3,6 +3,7 @@
 * Qualcomm Technologies Proprietary and Confidential.                              *
 **********************************************************************/
 
+#include <errno.h>
 #include "eztune.h"
 /* Keep following header as the last header in this list since it has
 #pragma pack(1) */
diff --git a/server/core/mctl/mctl.c b/server/core/mctl/mctl.c
index f1b403a..4f3d090 100644
--- a/server/core/mctl/mctl.c
+++ b/server/core/mctl/mctl.c
@@ -27,7 +27,10 @@
 #include "mctl_pp.h"
 #include "mctl_stats.h"
 #include "mctl_ez.h"
+
+#ifdef _ANDROID
 #include <cutils/properties.h>
+#endif
 
 #if 0
 #undef CDBG
@@ -526,7 +529,8 @@ static int mctl_init_comps(mctl_config_ctrl_t* p_cfg_ctrl, uint32_t comp_mask)
          0 ==> Legacy stats
          4 ==> Bayer stats
       */
-      p_cfg_ctrl->vfe_ver.main = 0;
+      p_cfg_ctrl->vfe_ver.main = VFE_STATS_TYPE_LEGACY;
+#ifdef _ANDROID
       char property[100];
       if (property_get("persist.camera.bayer_enable", property, NULL) > 0) {
         if(atoi(property) > 0)
@@ -534,6 +538,7 @@ static int mctl_init_comps(mctl_config_ctrl_t* p_cfg_ctrl, uint32_t comp_mask)
         else
           p_cfg_ctrl->vfe_ver.main = VFE_STATS_TYPE_LEGACY;
       }
+#endif
       rc = p_cfg_ctrl->comp_ops[MCTL_COMPID_VFE].set_params(
                        p_cfg_ctrl->comp_ops[MCTL_COMPID_VFE].handle,
                        VFE_SET_STATS_VERSION,
@@ -544,11 +549,13 @@ static int mctl_init_comps(mctl_config_ctrl_t* p_cfg_ctrl, uint32_t comp_mask)
       }
 
       p_cfg_ctrl->is_tintless_enabled = 0;
+#ifdef _ANDROID
       char tintless[100];
       if (property_get("persist.camera.tintless_enable", tintless, NULL) > 0) {
         if((atoi(tintless) > 0) && (p_cfg_ctrl->vfe_ver.main > 0))
           p_cfg_ctrl->is_tintless_enabled = 1;
       }
+#endif
       rc = p_cfg_ctrl->comp_ops[MCTL_COMPID_VFE].set_params(
                        p_cfg_ctrl->comp_ops[MCTL_COMPID_VFE].handle,
                        VFE_SET_RDI_INTF,
@@ -1035,7 +1042,9 @@ int mctl_init(m_ctrl_t* pme)
   sensor_get_t sensor_get;
   module_ops_t *s_comp_ops = NULL;
   mctl_config_ctrl_t *p_cfg_ctrl = NULL;
+#ifdef _ANDROID_
   char value[PROPERTY_VALUE_MAX];
+#endif
 
   if (!pme || !pme->p_cfg_ctrl) {
     CDBG_ERROR("%s: Invalid Input", __func__);
diff --git a/server/core/mctl/mctl_divert.c b/server/core/mctl/mctl_divert.c
index 3720c20..1e99471 100644
--- a/server/core/mctl/mctl_divert.c
+++ b/server/core/mctl/mctl_divert.c
@@ -13,7 +13,10 @@
 #include <poll.h>
 #include <sys/socket.h>
 #include <linux/un.h>
+#ifdef _ANDROID
 #include <cutils/properties.h>
+#endif
+#include <linux/mman.h>
 #include "camera_dbg.h"
 #include "camera.h"
 #include "cam_mmap.h"
@@ -27,7 +30,7 @@
 
 #define BUFF_SIZE_128 128
 #define DUMP_YUV 0
-
+#define MAP_FAILED ((void *)-1)
 #if 0
 #undef CDBG
 #define CDBG LOGE
@@ -430,11 +433,15 @@ static int dump_frame_VFE(mctl_config_ctrl_t *ctrl, struct msm_cam_evt_divert_fr
   int enabled = 0;
   static int frm_no = 0;
   int w, h, file_fd;
+#ifdef _ANDROID
   char value[PROPERTY_VALUE_MAX];
+#endif
   char buf[BUFF_SIZE_128];
 
+#ifdef _ANDROID
   property_get("persist.camera.vfe_divert_dump", value, "0");
   enabled = atoi(value);
+#endif
 
   if(enabled && frm_no++ < 10) /* Print first ten frames */
   {
diff --git a/server/core/mctl/mctl_proc.c b/server/core/mctl/mctl_proc.c
index 8fe163c..b5a860c 100644
--- a/server/core/mctl/mctl_proc.c
+++ b/server/core/mctl/mctl_proc.c
@@ -14,6 +14,7 @@
 #include <stdlib.h>
 #include <string.h>
 #include <errno.h>
+#include <fcntl.h>
 
 #include "camera.h"
 #include "mctl.h"
diff --git a/server/features/hdr/hdr.c b/server/features/hdr/hdr.c
index 0c5cce3..ec5640e 100755
--- a/server/features/hdr/hdr.c
+++ b/server/features/hdr/hdr.c
@@ -9,6 +9,7 @@
 #include <cutils/properties.h>
 #endif
 #include <stdlib.h>
+#include <errno.h>
 #include "camera_dbg.h"
 #include "hdr.h"
 #include "mctl.h"
diff --git a/server/features/live_snapshot/live_snapshot.c b/server/features/live_snapshot/live_snapshot.c
index 59eb135..c659277 100755
--- a/server/features/live_snapshot/live_snapshot.c
+++ b/server/features/live_snapshot/live_snapshot.c
@@ -9,6 +9,9 @@
 #include <cutils/properties.h>
 #endif
 #include <stdlib.h>
+#include <fcntl.h>
+#include <sys/stat.h>
+#include <errno.h>
 #include "camera_dbg.h"
 #include "live_snapshot.h"
 #include "mctl.h"
diff --git a/server/features/zoom/zoom.c b/server/features/zoom/zoom.c
index 73a2fde..91f50d4 100755
--- a/server/features/zoom/zoom.c
+++ b/server/features/zoom/zoom.c
@@ -5,6 +5,7 @@
 #include <sys/ioctl.h>
 #include <stdint.h>
 #include <string.h>
+#include <errno.h>
 #include "camera_dbg.h"
 #include "zoom.h"
 #include "mctl.h"
diff --git a/server/frameproc/face_proc/face_proc_util.c b/server/frameproc/face_proc/face_proc_util.c
index e8d84c8..5535d35 100755
--- a/server/frameproc/face_proc/face_proc_util.c
+++ b/server/frameproc/face_proc/face_proc_util.c
@@ -4,6 +4,8 @@
 **********************************************************************/
 
 #include <sys/time.h>
+#include <sys/types.h>
+#include <stdbool.h>
 #include "camera_dbg.h"
 #include "face_proc_util.h"
 #include "faceproc_engine.h"
diff --git a/server/frameproc/frameproc.c b/server/frameproc/frameproc.c
index a57197c..42b5759 100644
--- a/server/frameproc/frameproc.c
+++ b/server/frameproc/frameproc.c
@@ -6,6 +6,9 @@ Qualcomm Technologies Proprietary and Confidential.
 ============================================================================*/
 #include <string.h>
 
+#include <sys/types.h>
+#include <errno.h>
+#include <stdbool.h>
 #include "camera_dbg.h"
 #include "frameproc.h"
 
diff --git a/server/frameproc/hdr/hdr.h b/server/frameproc/hdr/hdr.h
index e619afb..b7146b5 100755
--- a/server/frameproc/hdr/hdr.h
+++ b/server/frameproc/hdr/hdr.h
@@ -14,10 +14,13 @@ INCLUDE FILES
 
 #include <sys/types.h>
 #include <stdlib.h>
+#include <stdint.h>
 #include <stdio.h>
 #include <math.h>
 #include <string.h>
 #include <time.h>
+#include <inttypes.h>
+#include <fcntl.h>
 #include <camera_dbg.h>
 
 #if(FRAME_PROC_HDR_DEBUG)
@@ -30,7 +33,7 @@ INCLUDE FILES
 #else
   #define CDBG_HDR(fmt, args...) do{}while(0)
 #endif
-#define CDBG_ERROR(fmt, args...) LOGE(fmt, ##args)
+/*#define CDBG_ERROR(fmt, args...) LOGE(fmt, ##args)*/
 
 /*============================================================================
 DEFINITIONS and CONSTANTS
diff --git a/server/frameproc/hdr/hdr_interface.c b/server/frameproc/hdr/hdr_interface.c
index c0e28a9..cf88a24 100755
--- a/server/frameproc/hdr/hdr_interface.c
+++ b/server/frameproc/hdr/hdr_interface.c
@@ -3,6 +3,8 @@
   Qualcomm Technologies Proprietary and Confidential.
 **********************************************************************/
 #include <string.h>
+#include <fcntl.h>
+#include <errno.h>
 #include "hdr.h"
 #include "frameproc.h"
 #include <sys/time.h>
diff --git a/server/frameproc/wavelet_denoise/wavelet_denoise_interface.c b/server/frameproc/wavelet_denoise/wavelet_denoise_interface.c
index 0304114..bfd6ea3 100644
--- a/server/frameproc/wavelet_denoise/wavelet_denoise_interface.c
+++ b/server/frameproc/wavelet_denoise/wavelet_denoise_interface.c
@@ -3,6 +3,7 @@ Copyright (C) 2011-2012 Qualcomm Technologies, Inc. All Rights Reserved.
 Qualcomm Technologies Proprietary and Confidential.
 ====================================================================== */
 #include <string.h>
+#include <errno.h>
 #include "frameproc.h"
 #include "camera_dbg.h"
 #include "wavelet_denoise_interface.h"
diff --git a/server/hardware/actuator/0208/af_tuning.h b/server/hardware/actuator/0208/af_tuning.h
index b2a9344..6f2a501 100644
--- a/server/hardware/actuator/0208/af_tuning.h
+++ b/server/hardware/actuator/0208/af_tuning.h
@@ -7,8 +7,9 @@
 #ifndef __AF_TUNING_H__
 #define __AF_TUNING_H__
 
+#include <stdint.h>
 #include <media/msm_camera.h>
-
+#include "chromatix.h"
 
 /******************************************************************************
 AF data types
diff --git a/server/hardware/actuator/actuator.c b/server/hardware/actuator/actuator.c
index db6d559..2abf01d 100644
--- a/server/hardware/actuator/actuator.c
+++ b/server/hardware/actuator/actuator.c
@@ -7,6 +7,7 @@
 #include <inttypes.h>
 #include <string.h>
 #include <sys/types.h>
+#include <errno.h>
 #include "camera_dbg.h"
 #include <media/msm_camera.h>
 #include "af_tuning.h"
diff --git a/server/hardware/actuator/actuator_interface.c b/server/hardware/actuator/actuator_interface.c
index fb752ed..47bb724 100644
--- a/server/hardware/actuator/actuator_interface.c
+++ b/server/hardware/actuator/actuator_interface.c
@@ -7,6 +7,7 @@
 #include <string.h>
 #include <inttypes.h>
 #include <sys/time.h>
+#include <errno.h>
 #include "af_tuning.h"
 #include "actuator.h"
 #include "camera_dbg.h"
diff --git a/server/hardware/axi/ARM_AXI/axi.c b/server/hardware/axi/ARM_AXI/axi.c
index 97ad522..9d37f1d 100755
--- a/server/hardware/axi/ARM_AXI/axi.c
+++ b/server/hardware/axi/ARM_AXI/axi.c
@@ -5,6 +5,8 @@
 #include <unistd.h>
 #include <inttypes.h>
 #include <assert.h>
+#include <errno.h>
+#include <stdbool.h>
 #include <media/msm_isp.h>
 #include "camera_dbg.h"
 #include "axi.h"
@@ -339,7 +341,7 @@ static int axi_update_UB_data(axi_obj_t *axi_obj,
       + axi_obj->axi_wm_table[4].ub_info.ub_size;
 
     if (output_info->output[SECONDARY].format == CAMERA_YUV_420_YV12) {
-      assert(sec_wm_chroma >= 0);
+      /*assert(sec_wm_chroma >= 0);*/
       /* Two chroma planes size: W * H * 1/4 each*/
       axi_obj->axi_wm_table[5].ub_info.ub_size = minUbSize + MAX(1,
         (int32_t)((imageHeight/2 * imageWidth/2 * totalUbSize)/totalSize - 1));
@@ -407,7 +409,7 @@ try_again:
 
     prev_p1_size = minUbSize + (imageWidth / 16);
     if (output_info->output[SECONDARY].format == CAMERA_YUV_420_YV12) {
-      assert(sec_wm_chroma >= 0);
+      /*assert(sec_wm_chroma >= 0);*/
       /* Two chroma planes size: W * H * 1/4 each*/
       prev_p2_size = minUbSize + (imageWidth / 32);
       prev_p3_size = minUbSize + (imageWidth / 32);
diff --git a/server/hardware/axi/axi_interface.c b/server/hardware/axi/axi_interface.c
index 1e88bb8..f8ee4b5 100755
--- a/server/hardware/axi/axi_interface.c
+++ b/server/hardware/axi/axi_interface.c
@@ -6,6 +6,8 @@
 #include <errno.h>
 #include <string.h>
 #include <stdlib.h>
+#include <fcntl.h>
+#include <stdbool.h>
 #include "axi.h"
 #include "camera_dbg.h"
 
diff --git a/server/hardware/c2d_client/c2d_client.c b/server/hardware/c2d_client/c2d_client.c
index e482a62..cfda3c4 100644
--- a/server/hardware/c2d_client/c2d_client.c
+++ b/server/hardware/c2d_client/c2d_client.c
@@ -11,6 +11,7 @@
 #include <string.h>
 #include <errno.h>
 #include <dlfcn.h>
+#include <stdint.h>
 #include <linux/msm_kgsl.h>
 #include <sys/mman.h>
 #include <ctype.h>
@@ -19,7 +20,9 @@
 #include "camera_dbg.h"
 #include "mctl_pp.h"
 #include "c2d_client_intf.h"
+#ifdef _ANDROID
 #include <cutils/properties.h>
+#endif
 
 #if 0
 #undef CDBG
@@ -789,10 +792,12 @@ static uint32_t c2d_get_target_flip(int type)
 {
 
   uint32_t ret = 0;
+#ifdef _ANDROID
   char val[PROPERTY_VALUE_MAX] = {0};
   if (property_get("debug.camera.flip", val, 0)) {
     type = atoi(val);
   }
+#endif
 
   if (type & FLIP_H) ret |= C2D_MIRROR_H_BIT;
 
diff --git a/server/hardware/camif/ARM_CAMIF/camif.c b/server/hardware/camif/ARM_CAMIF/camif.c
index f2c28e7..19175ee 100644
--- a/server/hardware/camif/ARM_CAMIF/camif.c
+++ b/server/hardware/camif/ARM_CAMIF/camif.c
@@ -3,6 +3,7 @@
    Qualcomm Technologies Proprietary and Confidential.
 ============================================================================*/
 #include <unistd.h>
+#include <errno.h>
 #include "camera_dbg.h"
 #include "camif.h"
 
diff --git a/server/hardware/camif/camif_interface.c b/server/hardware/camif/camif_interface.c
index 70a3697..3eefb96 100755
--- a/server/hardware/camif/camif_interface.c
+++ b/server/hardware/camif/camif_interface.c
@@ -6,6 +6,7 @@
 #include "camif.h"
 #include "camif_interface.h"
 #include "camera_dbg.h"
+#include <errno.h>
 
 static camif_comp_root_t my_camif_struct;
 
diff --git a/server/hardware/csi/csi2/csi.c b/server/hardware/csi/csi2/csi.c
index 8cd5087..3bd3924 100644
--- a/server/hardware/csi/csi2/csi.c
+++ b/server/hardware/csi/csi2/csi.c
@@ -5,6 +5,7 @@
 
 ============================================================================*/
 
+#include <errno.h>
 #include "csi.h"
 #include "csid.h"
 #include "csiphy.h"
diff --git a/server/hardware/csi/csi_interface.c b/server/hardware/csi/csi_interface.c
index 919eb44..bcbdbb4 100644
--- a/server/hardware/csi/csi_interface.c
+++ b/server/hardware/csi/csi_interface.c
@@ -4,6 +4,8 @@
    Qualcomm Technologies Proprietary and Confidential.
 
 ===========================================================*/
+
+#include <errno.h>
 #include "csi.h"
 #include "camera_dbg.h"
 
diff --git a/server/hardware/dsps/dsps_hw.h b/server/hardware/dsps/dsps_hw.h
index 3e565b8..bdfbc59 100755
--- a/server/hardware/dsps/dsps_hw.h
+++ b/server/hardware/dsps/dsps_hw.h
@@ -20,6 +20,7 @@
 #include <stdbool.h>
 #include <pthread.h>
 #include <stdlib.h>
+#include <stdint.h>
 #include "stats_proc_interface.h"
 #include "camera_dbg.h"
 #include "dsps_hw_interface.h"
diff --git a/server/hardware/eeprom/eeprom_interface.c b/server/hardware/eeprom/eeprom_interface.c
index 3030cbc..384c136 100644
--- a/server/hardware/eeprom/eeprom_interface.c
+++ b/server/hardware/eeprom/eeprom_interface.c
@@ -4,6 +4,8 @@
    Qualcomm Technologies Proprietary and Confidential.
 
 ===========================================================*/
+
+#include <errno.h>
 #include "eeprom.h"
 #include "camera_dbg.h"
 
diff --git a/server/hardware/ispif/ispif_interface.c b/server/hardware/ispif/ispif_interface.c
index be3b528..b90df66 100755
--- a/server/hardware/ispif/ispif_interface.c
+++ b/server/hardware/ispif/ispif_interface.c
@@ -4,6 +4,8 @@
    Qualcomm Technologies Proprietary and Confidential.
 
 ===========================================================*/
+
+#include <errno.h>
 #include "ispif.h"
 #include "camera_dbg.h"
 
diff --git a/server/hardware/sensor/imx135/imx135_u.c b/server/hardware/sensor/imx135/imx135_u.c
index 37f3f4b..a92499c 100644
--- a/server/hardware/sensor/imx135/imx135_u.c
+++ b/server/hardware/sensor/imx135/imx135_u.c
@@ -8,6 +8,7 @@
 #include <unistd.h>
 #include <sys/ioctl.h>
 #include <math.h>
+#include <errno.h>
 #include "camera_dbg.h"
 #include "sensor_util.h"
 #include "imx135_u.h"
diff --git a/server/hardware/sensor/sensor.c b/server/hardware/sensor/sensor.c
index 957fad8..5cccb69 100644
--- a/server/hardware/sensor/sensor.c
+++ b/server/hardware/sensor/sensor.c
@@ -15,6 +15,7 @@
 #include <string.h>
 #include <sys/ioctl.h>
 #include <dlfcn.h>
+#include <errno.h>
 
 #include "camera_dbg.h"
 #include "sensor.h"
diff --git a/server/hardware/sensor/sensor.h b/server/hardware/sensor/sensor.h
index f5e5765..5423589 100644
--- a/server/hardware/sensor/sensor.h
+++ b/server/hardware/sensor/sensor.h
@@ -11,6 +11,7 @@
 /*============================================================================
                         INCLUDE FILES
 ============================================================================*/
+#include <stdint.h>
 #include "tgtcommon.h"
 #include "chromatix.h"
 #include "sensor_interface.h"
diff --git a/server/hardware/sensor/sensor_interface.c b/server/hardware/sensor/sensor_interface.c
index 2146f94..f3ced91 100644
--- a/server/hardware/sensor/sensor_interface.c
+++ b/server/hardware/sensor/sensor_interface.c
@@ -12,6 +12,7 @@
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <fcntl.h>
+#include <errno.h>
 #include "camera_dbg.h"
 #include "sensor_interface.h"
 #include "sensor.h"
diff --git a/server/hardware/sensor/sensor_util.c b/server/hardware/sensor/sensor_util.c
index 100d437..87d19af 100644
--- a/server/hardware/sensor/sensor_util.c
+++ b/server/hardware/sensor/sensor_util.c
@@ -8,6 +8,8 @@
 /*============================================================================
  *                      INCLUDE FILES
  *===========================================================================*/
+
+#include <errno.h>
 #include "sensor_util.h"
 #include "camera_dbg.h"
 
diff --git a/server/hardware/vfe/vfe32/8960/vfe_tgtcommon.h b/server/hardware/vfe/vfe32/8960/vfe_tgtcommon.h
index f536d33..dbaf4f3 100644
--- a/server/hardware/vfe/vfe32/8960/vfe_tgtcommon.h
+++ b/server/hardware/vfe/vfe32/8960/vfe_tgtcommon.h
@@ -5,6 +5,8 @@
 #ifndef __VFE_TGTCOMMON_H__
 #define __VFE_TGTCOMMON_H__
 
+#include <inttypes.h>
+
 #define VFE_PIXEL_IF_MIPI 3
 
 #define MSM8960V1 0x3030b
diff --git a/server/hardware/vfe/vfe32/common/vfe.c b/server/hardware/vfe/vfe32/common/vfe.c
index b950123..bb1da32 100644
--- a/server/hardware/vfe/vfe32/common/vfe.c
+++ b/server/hardware/vfe/vfe32/common/vfe.c
@@ -375,11 +375,13 @@ vfe_status_t vfe_params_init(vfe_ctrl_info_t *vfe_obj, vfe_params_t *params)
   params->effects_params.contrast = 0;
 
   params->enable_tintless = 0;
+#ifdef _ANDROID
   char tintless[100];
   if (property_get("persist.camera.tintless_enable", tintless, NULL) > 0) {
     if(atoi(tintless) > 0)
       params->enable_tintless = 1;
   }
+#endif
   params->zsl_capture = FALSE;
   return VFE_SUCCESS;
 }
@@ -3537,7 +3539,7 @@ static int vfe_set_params(void *client, int type, void *parm_in,
     uint32_t *cmd = (uint32_t *)parm_in;
     rc = 0;
     vfe_ctrl_obj->vfe_params.zsl_capture = *cmd;
-    ALOGE("%s: zsl_capture :%d\n", __func__,
+    CDBG_LOW("%s: zsl_capture :%d\n", __func__,
       vfe_ctrl_obj->vfe_params.zsl_capture);
     break;
   }
diff --git a/server/hardware/vfe/vfe32/common/vfe.h b/server/hardware/vfe/vfe32/common/vfe.h
index 1f1733d..20a47e5 100644
--- a/server/hardware/vfe/vfe32/common/vfe.h
+++ b/server/hardware/vfe/vfe32/common/vfe.h
@@ -6,6 +6,7 @@
 #ifndef __VFE_H__
 #define __VFE_H__
 
+#include <stdint.h>
 #include "vfe_interface.h"
 #include "vfe_util_common.h"
 #include "vfe_tgtcommon.h"
diff --git a/server/hardware/vfe/vfe_interface/vfe_interface.c b/server/hardware/vfe/vfe_interface/vfe_interface.c
index c56d1e5..7170d87 100755
--- a/server/hardware/vfe/vfe_interface/vfe_interface.c
+++ b/server/hardware/vfe/vfe_interface/vfe_interface.c
@@ -9,7 +9,7 @@
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <fcntl.h>
-
+#include <errno.h>
 #include "vfe.h"
 #include "vfe_util_common.h"
 #include "camera_dbg.h"
diff --git a/server/hardware/vfe/vfe_interface/vfe_interface.h b/server/hardware/vfe/vfe_interface/vfe_interface.h
index c50ea8b..780fa44 100644
--- a/server/hardware/vfe/vfe_interface/vfe_interface.h
+++ b/server/hardware/vfe/vfe_interface/vfe_interface.h
@@ -5,6 +5,7 @@
 #ifndef __VFE_INTERFACE_H__
 #define __VFE_INTERFACE_H__
 
+#include <stdint.h>
 #include "tgtcommon.h"
 #include "intf_comm_data.h"
 #include "chromatix.h"
diff --git a/server/hardware/vfe/vfe_modules/clamp/clamp_intf.c b/server/hardware/vfe/vfe_modules/clamp/clamp_intf.c
index c0ee193..ee027c1 100644
--- a/server/hardware/vfe/vfe_modules/clamp/clamp_intf.c
+++ b/server/hardware/vfe/vfe_modules/clamp/clamp_intf.c
@@ -3,6 +3,7 @@
    Qualcomm Technologies Proprietary and Confidential.
 ============================================================================*/
 #include <unistd.h>
+#include <stdint.h>
 #include "camera_dbg.h"
 #include "vfe.h"
 /*===========================================================================
diff --git a/server/hardware/vfe/vfe_modules/rolloff/pca_rolloff.c b/server/hardware/vfe/vfe_modules/rolloff/pca_rolloff.c
index 3815228..152aee4 100644
--- a/server/hardware/vfe/vfe_modules/rolloff/pca_rolloff.c
+++ b/server/hardware/vfe/vfe_modules/rolloff/pca_rolloff.c
@@ -4,6 +4,7 @@
 ============================================================================*/
 #include <string.h>
 #include <stdlib.h>
+#include <fcntl.h>
 #include "vfe.h"
 #include "camera_dbg.h"
 #include <inttypes.h>
@@ -11,7 +12,9 @@
 #include "pca_rolloff.h"
 #include "mlro.h"
 #include "tintless_interface.h"
+#ifdef _ANDROID 
 #include <cutils/properties.h>
+#endif
 #include <stdio.h>
 #include <stdlib.h>
 
@@ -959,6 +962,7 @@ vfe_status_t pca_rolloff_init(pca_rolloff_mod_t* pca_rolloff_ctrl,
   chromatix_parms_type *chrPtr = NULL;
   pca_rolloff_ctrl->tintless_ctrl.is_tintless_enabled = 0;
 
+#ifdef _ANDROID
   char bayerstats[100];
   if (property_get("persist.camera.bayer_enable", bayerstats, NULL) > 0) {
     if((atoi(bayerstats) > 0) && vfe_params->enable_tintless) {
@@ -966,6 +970,7 @@ vfe_status_t pca_rolloff_init(pca_rolloff_mod_t* pca_rolloff_ctrl,
       CDBG_HIGH("%s: Tintless Enabled!!", __func__);
     }
   }
+#endif
 
   // Check if tintless is enabled
   if(pca_rolloff_ctrl->tintless_ctrl.is_tintless_enabled) {
@@ -1192,13 +1197,17 @@ vfe_status_t pca_rolloff_BG_get_stats(pca_rolloff_mod_t* pca_rolloff_ctrl,
   char* ext = "bin";
   int index = 1;
 
+#ifdef _ANDROID
   char value[PROPERTY_VALUE_MAX];
+#endif
   char buf[32];
   int main_422 = 1;
   int32_t dump_enabled = 0;
 
+#ifdef _ANDROID
   property_get("persist.camera.tintless_dumpimg", value, "0");
   dump_enabled = atoi(value);
+#endif
   CDBG("%s: dump enabled %d", __func__, dump_enabled);
 
   if ((dump_enabled) && (pca_rolloff_ctrl->tintless_ctrl.skip_cnt == 0)) {
@@ -1259,12 +1268,16 @@ static vfe_status_t pca_rolloff_tintless_generate(
   char* output_name = "output_mesh";
   char* hw_name = "hw_mesh";
   char* ext = "txt";
+#ifdef _ANDROID
   char value[PROPERTY_VALUE_MAX];
+#endif
   char buf[32];
   int32_t dump_enabled = 0;
 
+#ifdef _ANDROID
   property_get("persist.camera.tintless_dumpimg", value, "0");
   dump_enabled = atoi(value);
+#endif
 
  /* updating every 10th frame doesnt need queue */
   currenthwtable = pca_rolloff_ctrl->tintless_ctrl.prev_mesh;
diff --git a/server/hardware/vfe/vfe_modules/rolloff/rolloff.c b/server/hardware/vfe/vfe_modules/rolloff/rolloff.c
index c81a759..fd0d104 100644
--- a/server/hardware/vfe/vfe_modules/rolloff/rolloff.c
+++ b/server/hardware/vfe/vfe_modules/rolloff/rolloff.c
@@ -4,6 +4,7 @@
 ============================================================================*/
 #include <string.h>
 #include <stdlib.h>
+#include <stdint.h>
 #include "camera_dbg.h"
 #include "vfe_tgtcommon.h"
 #include "vfe.h"
diff --git a/server/hardware/vfe/vfe_modules/stats/config/aec_stats.c b/server/hardware/vfe/vfe_modules/stats/config/aec_stats.c
index 258253f..ead2a4a 100755
--- a/server/hardware/vfe/vfe_modules/stats/config/aec_stats.c
+++ b/server/hardware/vfe/vfe_modules/stats/config/aec_stats.c
@@ -3,6 +3,7 @@
    Qualcomm Technologies Proprietary and Confidential.
 ============================================================================*/
 #include <unistd.h>
+#include <stdint.h>
 #include "camera_dbg.h"
 #include "vfe.h"
 
diff --git a/server/hardware/vfe/vfe_modules/stats/config/af_stats.c b/server/hardware/vfe/vfe_modules/stats/config/af_stats.c
index e9b3a23..08e6e05 100755
--- a/server/hardware/vfe/vfe_modules/stats/config/af_stats.c
+++ b/server/hardware/vfe/vfe_modules/stats/config/af_stats.c
@@ -4,6 +4,7 @@
 ============================================================================*/
 
 #include <unistd.h>
+#include <stdint.h>
 #include "vfe.h"
 #include "camera_dbg.h"
 
diff --git a/server/hardware/vfe/vfe_modules/stats/config/awb_stats.c b/server/hardware/vfe/vfe_modules/stats/config/awb_stats.c
index 4095281..905d5dc 100755
--- a/server/hardware/vfe/vfe_modules/stats/config/awb_stats.c
+++ b/server/hardware/vfe/vfe_modules/stats/config/awb_stats.c
@@ -4,6 +4,7 @@
 ============================================================================*/
 
 #include <stddef.h>
+#include <stdbool.h>
 #include "camera_dbg.h"
 #include "vfe.h"
 
diff --git a/server/hardware/vfe/vfe_modules/stats/config/be_stats.c b/server/hardware/vfe/vfe_modules/stats/config/be_stats.c
index f8ff35a..43dab75 100644
--- a/server/hardware/vfe/vfe_modules/stats/config/be_stats.c
+++ b/server/hardware/vfe/vfe_modules/stats/config/be_stats.c
@@ -5,6 +5,7 @@
 #include <unistd.h>
 #include "camera_dbg.h"
 #include "vfe.h"
+#include "be_stats.h"
 
 #define ENABLE_BAYER_EXPOSURE_LOGGING 0
 #if ENABLE_BAYER_EXPOSURE_LOGGING
diff --git a/server/hardware/vfe/vfe_modules/stats/config/be_stats_intf.c b/server/hardware/vfe/vfe_modules/stats/config/be_stats_intf.c
index b8ad148..1a929e9 100644
--- a/server/hardware/vfe/vfe_modules/stats/config/be_stats_intf.c
+++ b/server/hardware/vfe/vfe_modules/stats/config/be_stats_intf.c
@@ -6,6 +6,7 @@
 ============================================================================*/
 #include "camera_dbg.h"
 #include "vfe.h"
+#include "be_stats.h"
 
 #ifdef ENABLE_BE_STATS_LOGGING
   #undef CDBG
diff --git a/server/hardware/vfe/vfe_modules/stats/parser/stats_parser.c b/server/hardware/vfe/vfe_modules/stats/parser/stats_parser.c
index 1c0c300..dab6c5d 100644
--- a/server/hardware/vfe/vfe_modules/stats/parser/stats_parser.c
+++ b/server/hardware/vfe/vfe_modules/stats/parser/stats_parser.c
@@ -12,6 +12,7 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <unistd.h>
+#include <stdint.h>
 #include <pthread.h>
 #include <sys/ioctl.h>
 #include <string.h>
diff --git a/server/hardware/vpe1/vpe.c b/server/hardware/vpe1/vpe.c
index fecb639..0a87265 100755
--- a/server/hardware/vpe1/vpe.c
+++ b/server/hardware/vpe1/vpe.c
@@ -6,12 +6,19 @@
 #include <string.h>
 #include <sys/time.h>
 #include <linux/media.h>
+#include <fcntl.h>
+#include <errno.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+
 #include "camera_dbg.h"
 #include "vpe_api.h"
 #include "vpe_util.h"
 #include "vpe_proc.h"
 #include "mctl_pp.h"
+#ifdef _ANDROID
 #include <cutils/properties.h>
+#endif
 
 #if 0
 #undef CDBG
@@ -290,7 +297,9 @@ int vpe_config_pipeline(uint32_t handle, mm_vpe_pipe_config_parm_type *cfg)
   int vpe_rot = 0;
   int vpe_flip = 0;
 
+#ifdef _ANDROID
   char value[PROPERTY_VALUE_MAX] = {0};
+#endif
 
   hw_op_mode = vpe_default_op_mode_packed; //0x40FC0004
 
@@ -387,10 +396,12 @@ int vpe_config_pipeline(uint32_t handle, mm_vpe_pipe_config_parm_type *cfg)
     vpe_flip = FLIP_NONE;
   }
 
+#ifdef _ANDROID
   if (property_get("debug.camera.flip", value, 0)) {
     vpe_flip = atoi(value);
     hw_op_mode.rot_en = vpe_flip ? 1 : 0;
   }
+#endif
 
   CDBG("vpe_rot = %d, vpe_flip = %d", vpe_rot, vpe_flip);
 
@@ -905,7 +916,8 @@ static void vpe_thread_release()
 
 static int vpe_open_device() {
   int dev_fd = 0;
-  CDBG("%s Opening VPE device %s %d", __func__, my_vpe_obj.dev_name, gettid());
+  /*CDBG("%s Opening VPE device %s %d", __func__, my_vpe_obj.dev_name, gettid());*/
+  CDBG("%s Opening VPE device %s", __func__, my_vpe_obj.dev_name);
   dev_fd = open(my_vpe_obj.dev_name, O_RDWR | O_NONBLOCK);
   if (dev_fd < 0) {
     CDBG_ERROR("%s VPE Subdev open failed", __func__);
diff --git a/server/include/tgtcommon.h b/server/include/tgtcommon.h
index 18f91a5..babccbf 100755
--- a/server/include/tgtcommon.h
+++ b/server/include/tgtcommon.h
@@ -9,6 +9,7 @@
 /*===========================================================================
  *                         INCLUDE FILES
  *===========================================================================*/
+#include <stdint.h>
 #include <media/msm_camera.h>
 #include <media/msm_isp.h>
 #include "camera.h"
diff --git a/server/statsproc/stats_proc.c b/server/statsproc/stats_proc.c
index f27c4cd..4abf99e 100644
--- a/server/statsproc/stats_proc.c
+++ b/server/statsproc/stats_proc.c
@@ -410,11 +410,11 @@ static int stats_proc_load_lib(stats_proc_t *sproc)
 {
   int rc = 0;
   if (sproc->input.mctl_info.vfe_ver_main >= 4) {
-    ALOGE("Opening libmmcamera_3a_bayer.so!!");
+    CDBG_LOW("Opening libmmcamera_3a_bayer.so!!");
     sproc->lib.ptr =
       dlopen("libmmcamera_3a_bayer.so", RTLD_NOW);
   } else {
-    ALOGE("Opening libmmcamera_3a_legacy.so!!");
+    CDBG_LOW("Opening libmmcamera_3a_legacy.so!!");
     sproc->lib.ptr =
       dlopen("libmmcamera_3a_legacy.so", RTLD_NOW);
   }
-- 
1.8.2.1

